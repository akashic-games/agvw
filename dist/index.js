require=function o(a,s,l){function u(t,e){if(!s[t]){if(!a[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(d)return d(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return u(a[t][1][e]||e)},i,i.exports,o,a,s,l)}return s[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AkashicGameView=void 0;var n=e("./SharedObject"),i=e("./DomElement"),o=e("./Error"),a=(s.prototype.addContent=function(e){if(null!=e.id)throw o.ErrorFactory.createInvalidOperationError("content already added: "+e.id);e.id=this._nextContentId++,e.start(this._gameViewShared,this._gameContentShared),this._contents[e.id+""]=e},s.prototype.removeContent=function(e){if(null==e.id)throw o.ErrorFactory.createInvalidOperationError("content already removed");e.destroy(),delete this._contents[e.id+""],e.id=null},s.prototype.removeAllContents=function(){var t=this;Object.keys(this._contents).forEach(function(e){t.removeContent(t._contents[e])})},s.prototype.setSocketOptions=function(e){this._gameViewShared.sessionManager.setSocketOptions(e)},s.prototype.registerExternalPlugin=function(e){this._gameViewShared.pluginManager.register(e)},s.prototype.setViewSize=function(e,t){this._gameContentShared.viewWidth=e,this._gameContentShared.viewHeight=t,this._gameContentShared.gameViewElement.setViewSize(e,t)},s.prototype.getViewSize=function(){return{width:this._gameContentShared.viewWidth,height:this._gameContentShared.viewHeight}},s.prototype.getContentById=function(e){return this._contents[e+""]},s.prototype.getGameViewSharedObject=function(){return this._gameViewShared},s.prototype.destroy=function(){this.destroyed()||(this.removeAllContents(),this._hasOwnGameViewShared&&(this._gameViewShared.destroyed()||this._gameViewShared.destroy(),this._hasOwnGameViewShared=!1),this._gameViewShared=null,this._gameContentShared=null)},s.prototype.destroyed=function(){return null==this._gameViewShared},s);function s(e){this._contents={},this._nextContentId=1,this._hasOwnGameViewShared=!1,this.vars={};var t=new i.GameViewElement(e.container);e.sharedObject?this._gameViewShared=e.sharedObject:(this._gameViewShared=new n.GameViewSharedObject({baseDownloader:e.baseDownloader,window:e.window,untrustedFrameUrl:e.untrustedFrameUrl,trustedChildOrigin:e.trustedChildOrigin}),this._hasOwnGameViewShared=!0),this._gameContentShared=new n.GameContentSharedObject({gameViewElement:t,gameViewWidth:e.width,gameViewHeight:e.height}),t.setViewSize(e.width,e.height)}r.AkashicGameView=a},{"./DomElement":4,"./Error":6,"./SharedObject":12}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calcNoneLayout=function(e){var t=e.naturalWidth,r=e.naturalHeight;return{x:a(e,t),y:s(e,r),width:t,height:r}},r.calcFillLayout=function(e){return{x:0,y:0,width:e.outerWidth,height:e.outerHeight}},r.calcAspectFitLayout=function(e){var t=e.outerWidth/e.naturalWidth,r=e.outerHeight/e.naturalHeight,n=Math.min(t,r),i=e.naturalWidth*n,o=e.naturalHeight*n;return{x:a(e,i),y:s(e,o),width:i,height:o}};var n=e("@akashic/akashic-gameview");function a(e,t){switch(e.horizontalAlignment){case n.HorizontalAlignment.Left:return 0;case n.HorizontalAlignment.Center:return(e.outerWidth-t)/2;case n.HorizontalAlignment.Right:return e.outerWidth-t;default:return 0}}function s(e,t){switch(e.verticalAlignment){case n.VerticalAlignment.Top:return 0;case n.VerticalAlignment.Center:return(e.outerHeight-t)/2;case n.VerticalAlignment.Bottom:return e.outerHeight-t;default:return 0}}},{"@akashic/akashic-gameview":28}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Content=void 0;var n=e("@akashic/akashic-gameview"),i=e("./utils"),o=e("./Error"),a=(s.prototype.destroy=function(){this._contentDestroyListeners.forEach(function(e){return e.onDestroy()})},s.prototype.addContentLoadListener=function(e){this._contentLoadListeners.addItem(e)},s.prototype.removeContentLoadListener=function(e){this._contentLoadListeners.removeItem(e)},s.prototype.addErrorListener=function(e){this._errorListeners.addItem(e)},s.prototype.removeErrorListener=function(e){this._errorListeners.removeItem(e)},s.prototype.addContentDestroyListener=function(e){this._contentDestroyListeners.addItem(e)},s.prototype.removeContentDestroyListener=function(e){this._contentDestroyListeners.removeItem(e)},s.prototype.setContentArea=function(e){this._contentArea=(0,i.assignObject)(this._contentArea||{},e),this._contentAreaNeedsUpdate=!0,this._update()},s.prototype.getContentArea=function(){return(0,i.assignObject)({},this._contentArea)},s.prototype.setZIndex=function(e){this._zIndex=e,this._zIndexNeedsUpdate=!0,this._update()},s.prototype.getZIndex=function(){return this._zIndex},s.prototype.moveTopMost=function(){if(this._gameContentShared)this.setZIndex(this._gameContentShared.largestZIndex+1);else{var t=o.ErrorFactory.createInvalidOperationError("moveTopMost");this._errorListeners.forEach(function(e){return e.onError(t)})}},s.prototype.setContentLayout=function(e){this._contentLayout=(0,i.assignObject)(this._contentLayout||{},e),this._contentLayoutNeedsUpdate=!0,this._update()},s.prototype.getContentLayout=function(){return(0,i.assignObject)({},this._contentLayout)},s.prototype.hide=function(){!1!==this._visibility&&(this._visibility=!1,this._visibilityNeedsUpdate=!0,this._update())},s.prototype.show=function(){!0!==this._visibility&&(this._visibility=!0,this._visibilityNeedsUpdate=!0,this._update())},s.prototype.isVisible=function(){return this._visibility},s.prototype.getDataBus=function(){return this._dataBus},s);function s(e,t){this._contentLoadListeners=new i.ObjectList,this._errorListeners=new i.ObjectList,this._contentDestroyListeners=new i.ObjectList,this._contentAreaNeedsUpdate=!1,this._zIndexNeedsUpdate=!1,this._contentLayout={scaleMode:n.ScaleMode.AspectFit,verticalAlignment:n.VerticalAlignment.Center,horizontalAlignment:n.HorizontalAlignment.Center,passthroughEvent:!0,backgroundColor:"transparent"},this._contentLayoutNeedsUpdate=!1,this._visibility=!0,this._visibilityNeedsUpdate=!1,this.id=null,this.vars={},this._gameContentShared=null,this._gameViewShared=null,this._contentArea=null,this._zIndex=null,this._dataBus=null,this.type=t,this._contentUrl=e.contentUrl,null!=e.contentArea&&this.setContentArea(e.contentArea),null!=e.zIndex&&this.setZIndex(e.zIndex),null!=e.contentLayout&&this.setContentLayout(e.contentLayout)}r.Content=a},{"./Error":6,"./utils":27,"@akashic/akashic-gameview":28}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GameContentElement=r.WebContentElement=r.GameViewElement=void 0;var n=e("@akashic/akashic-gameview"),h=e("./utils"),i={mousedown:n.DroppedEventType.Down,mousemove:n.DroppedEventType.Move,mouseup:n.DroppedEventType.Up,touchstart:n.DroppedEventType.Down,touchmove:n.DroppedEventType.Move,touchend:n.DroppedEventType.Up,click:n.DroppedEventType.Click},o=(a.prototype.appendChild=function(e){this._htmlElement.appendChild(e)},a.prototype.removeChild=function(e){this._htmlElement.removeChild(e)},a.prototype.destroy=function(){this._parent.removeChild(this._htmlElement)},a.prototype.setViewSize=function(e,t){this._htmlElement.style.width=e+"px",this._htmlElement.style.height=t+"px"},a);function a(e){var t=document.createElement("div");t.style.position="relative",t.style.overflow="hidden",t.style.pointerEvents="none",e.appendChild(t),this._parent=e,this._htmlElement=t}r.GameViewElement=o;var s=(l.prototype.destroy=function(){this._parent.removeChild(this._htmlElement)},l.prototype.setContentArea=function(e){this._htmlElement.style.left=e.x+"px",this._htmlElement.style.top=e.y+"px",this._htmlElement.style.width=e.width+"px",this._htmlElement.style.height=e.height+"px"},l.prototype.setContentLayout=function(e){this._htmlElement.style.backgroundColor=e.backgroundColor},l.prototype.setZIndex=function(e){this._htmlElement.style.zIndex=e+""},l.prototype.setVisibility=function(e){this._htmlElement.style.display=e?"block":"none"},l.prototype.getContentWindow=function(){return this._htmlElement.contentWindow},l);function l(e,t,r){var n=this,i=document.createElement("iframe");i.style.position="absolute",i.style.borderStyle="none",i.style.pointerEvents="auto",i.addEventListener("load",function(){setTimeout(function(){r(n._htmlElement)},0)}),i.src=t,e.appendChild(i),this._parent=e,this._htmlElement=i}r.WebContentElement=s;var u=(d.prototype.destroy=function(){this._cleanupDropDomEventListeners(),this._parent.removeChild(this._outerHtmlElement)},d.prototype.setInnerSize=function(e){this._innerHtmlElement.style.left=e.x+"px",this._innerHtmlElement.style.top=e.y+"px",this._innerHtmlElement.style.width=e.width+"px",this._innerHtmlElement.style.height=e.height+"px"},d.prototype.setContentArea=function(e){this._outerHtmlElement.style.left=e.x+"px",this._outerHtmlElement.style.top=e.y+"px",this._outerHtmlElement.style.width=e.width+"px",this._outerHtmlElement.style.height=e.height+"px"},d.prototype.setContentLayout=function(e){this._outerHtmlElement.style.backgroundColor=e.backgroundColor,this._outerHtmlElement.style.pointerEvents=e.passthroughEvent?"none":"auto"},d.prototype.setZIndex=function(e){this._outerHtmlElement.style.zIndex=e+""},d.prototype.setVisibility=function(e){this._outerHtmlElement.style.display=e?"block":"none"},d.prototype.getContentWindow=function(){return this._gameContainerHtmlElement.contentWindow},d.prototype.addDroppedDomEventListener=function(e){this._droppedDomEventListeners.addItem(e)},d.prototype.removeDroppedDomEventListener=function(e){this._droppedDomEventListeners.removeItem(e)},d.prototype.setDropDomEvent=function(e){e?(this._gameContainerHtmlElement.style.pointerEvents="none",this._innerHtmlElement.style.pointerEvents="auto",this._innerHtmlElement.addEventListener("mousedown",this._handleMouseDown_bound),this._innerHtmlElement.addEventListener("touchstart",this._handleTouchStart_bound),this._innerHtmlElement.addEventListener("click",this._handleClick_bound)):(this._gameContainerHtmlElement.style.pointerEvents="auto",this._innerHtmlElement.style.pointerEvents="none",this._cleanupDropDomEventListeners()),this._isDropDomEvent=e},d.prototype._cleanupDropDomEventListeners=function(){this._innerHtmlElement.removeEventListener("mousedown",this._handleMouseDown_bound),this._innerHtmlElement.removeEventListener("touchstart",this._handleTouchStart_bound),this._innerHtmlElement.removeEventListener("click",this._handleClick_bound),this._innerHtmlElement.removeEventListener("touchmove",this._handleTouchMove_bound),this._innerHtmlElement.removeEventListener("touchend",this._handleTouchEnd_bound),window.removeEventListener("mousemove",this._handleMouseMove_bound),window.removeEventListener("mouseup",this._handleMouseUp_bound)},d.prototype._handleMouseDown=function(e){this._isTouched||(window.addEventListener("mousemove",this._handleMouseMove_bound),window.addEventListener("mouseup",this._handleMouseUp_bound),this._fireDroppedDomEvent(e))},d.prototype._handleMouseMove=function(e){this._isTouched||this._fireDroppedDomEvent(e)},d.prototype._handleMouseUp=function(e){window.removeEventListener("mousemove",this._handleMouseMove_bound),window.removeEventListener("mouseup",this._handleMouseUp_bound),this._fireDroppedDomEvent(e)},d.prototype._handleTouchStart=function(e){this._isTouched=!0,this._innerHtmlElement.addEventListener("touchmove",this._handleTouchMove_bound),this._innerHtmlElement.addEventListener("touchend",this._handleTouchEnd_bound),this._fireDroppedDomEvent(e)},d.prototype._handleTouchMove=function(e){this._fireDroppedDomEvent(e)},d.prototype._handleTouchEnd=function(e){this._innerHtmlElement.removeEventListener("touchmove",this._handleTouchMove_bound),this._innerHtmlElement.removeEventListener("touchend",this._handleTouchEnd_bound),this._fireDroppedDomEvent(e)},d.prototype._handleClick=function(e){this._isTouched=!1,this._isDropDomEvent&&this._fireDroppedDomEvent(e)},d.prototype._fireDroppedDomEvent=function(t){var r=i[t.type];null!=r&&this._droppedDomEventListeners.forEach(function(e){return e(r,t)})},d);function d(e){var t=e.parent,r=e.frameSrc,n=e.onCreated,i=e.runInIframe,o=this;this._isDropDomEvent=!1,this._isTouched=!1,this._droppedDomEventListeners=new h.ObjectList,this._handleMouseDown_bound=this._handleMouseDown.bind(this),this._handleMouseMove_bound=this._handleMouseMove.bind(this),this._handleMouseUp_bound=this._handleMouseUp.bind(this),this._handleTouchStart_bound=this._handleTouchStart.bind(this),this._handleTouchMove_bound=this._handleTouchMove.bind(this),this._handleTouchEnd_bound=this._handleTouchEnd.bind(this),this._handleClick_bound=this._handleClick.bind(this);var a,s=document.createElement("div");if(s.style.position="absolute",s.style.overflow="hidden",s.style.pointerEvents="auto",r)(u=document.createElement("iframe")).addEventListener("load",function(){setTimeout(function(){n(window,o._innerHtmlElement)},0)}),u.sandbox="allow-scripts allow-same-origin",u.src=r,u.scrolling="no",a=u;else if(i){var l=document.createElement("iframe");l.name="trusted-loader-window",l.scrolling="no",l.addEventListener("load",function(){var e=l.contentWindow,t=l.contentDocument;t.body.style.padding="0",t.body.style.margin="0",t.body.addEventListener("contextmenu",function(e){return e.preventDefault()});var r=t.createElement("div");t.body.appendChild(r),n(e,r)}),a=l}else{var u=document.createElement("div");a=u,setTimeout(function(){return n(window,a)},0)}a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.borderStyle="none",a.style.overflow="hidden",a.style.pointerEvents="auto";var d=document.createElement("div");d.style.position="absolute",d.style.pointerEvents="none",d.appendChild(a),s.appendChild(d),t.appendChild(s),this._parent=t,this._outerHtmlElement=s,this._innerHtmlElement=d,this._gameContainerHtmlElement=a}r.GameContentElement=u},{"./utils":27,"@akashic/akashic-gameview":28}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RetryDownloader=r.XhrDownloader=void 0;var n=(i.prototype.start=function(t,r){var n=this._createXmlHttpRequest();return n.open("GET",t),n.responseType="text",n.timeout=this.defaultTimeOut,n.addEventListener("load",function(e){200<=n.status&&n.status<300?r(null,n.responseText):r(new Error("request failed: "+t),"")}),n.addEventListener("error",function(e){return r(new Error("request error: "+t),"")}),n.addEventListener("timeout",function(e){return r(new Error("request timed out: "+t),"")}),n.send(),{cancel:function(){n.readyState!==n.DONE&&n.abort()},isFinished:function(){return n.readyState===n.DONE}}},i);function i(e){void 0===e&&(e=15e3),this.defaultTimeOut=e,this._createXmlHttpRequest=function(){return new XMLHttpRequest}}r.XhrDownloader=n;var o=(a.prototype.start=function(t,r){var n=this,i={count:this.defaultRetry},o={cancel:function(){},isFinished:function(){return!1}},a=function(){var e=n.baseDownloader.start(t,function(e,t){null!=e?--i.count<=0?r(e,t):setTimeout(function(){return a()},0):r(null,t)});o.cancel=e.cancel,o.isFinished=e.isFinished};return setTimeout(function(){return a()},0),o},a);function a(e,t){void 0===e&&(e=new n),void 0===t&&(t=2),this.baseDownloader=e,this.defaultRetry=t}r.RetryDownloader=o},{}],6:[function(e,t,r){"use strict";var n,i;function o(r){return function(e){var t=new Error(r);return t.name=r,t.cause=e,t}}Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorFactory=void 0,(i=n||(r.ErrorFactory=n={})).createInvalidOperationError=o("InvalidOperation"),i.createGameDriverError=o("GameDriverError"),i.createLoadMuduleError=o("LoadMuduleError"),i.createPlaylogError=o("PlaylogError"),i.createHttpRequestError=o("HttpRequestError"),i.createInvalidGameError=o("InvalidGameError"),i.createAbortGameError=o("AbortGameError"),i.createPostMessageError=o("PostMessageError"),i.createInsecureFrameUrlError=o("InsecureFrameUrlError")},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalPluginManager=void 0;var n=e("@akashic/trigger"),i=(o.prototype.register=function(e){(this._externalPlugin[e.name]=e).implicit&&this._implicitPluginNames.push(e.name),e.onregister&&e.onregister(this),this.onRegister.fire(e)},o.prototype.find=function(e){return this._externalPlugin[e]},o.prototype.implicitPluginNames=function(){return this._implicitPluginNames},o);function o(){this.onRegister=new n.Trigger,this._externalPlugin={},this._implicitPluginNames=[]}r.ExternalPluginManager=i},{"@akashic/trigger":36}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalPluginSignatureCaller=void 0;var n=(i.prototype.call=function(e,t,r){var n=this._trustedFunctionTable[e];n&&n(t,r)},i.prototype.setupFunctionTable=function(e,t,n,r){if("function"===e.type){if(null!=e.callbackProp){var i=e.callbackProp.match(/arguments\[(\d+)\](?:\.(.+))?$/);if(null==i)throw new Error("invalid callbackProp geven");var o=parseInt(i[1],10),a=i[2];return void(this._trustedFunctionTable[r]=function(e,r){r&&(a&&null!=e[o]?(e[o][a]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r(null,e)},t[n].apply(t,e)):a?(t[n].apply(t,e),r(null)):(e[o]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r(null,e)},t[n].apply(t,e)))})}this._trustedFunctionTable[r]=function(e){return t[n].apply(t,e)}}else if("object"===e.type)for(var s=Object.keys(e.content),l=0;l<s.length;l++)this.setupFunctionTable(e.content[s[l]],t[n],s[l],r+":"+s[l])},i);function i(e,t){this._trustedFunctionTable=Object.create(null,{});for(var r=Object.keys(e.content),n=0;n<r.length;n++)this.setupFunctionTable(e.content[r[n]],t,r[n],r[n])}r.ExternalPluginSignatureCaller=n},{}],9:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.GameContent=void 0;var o,c=e("@akashic/akashic-gameview"),a=e("@cross-border-bridge/memory-queue"),s=e("@cross-border-bridge/memory-queue-data-bus"),l=e("./Content"),u=e("./DomElement"),p=e("./TrustedGameLoader"),_=e("./UntrustedGameLoader"),d=e("./utils"),g=e("./Error"),h=e("./CalcLayout"),f=(o=l.Content,i(m,o),m.prototype.start=function(e,t){var r=this;if(this._loadStartTime=(new Date).getTime(),this._gameViewShared=e,this._gameContentShared=t,this._customizer&&null!=this._customizer.overwriteEngineConfig){var n=this._customizer.overwriteEngineConfig;setTimeout(function(){return r._start_createElement(n)},0)}else this._gameViewShared.downloader.start(this._contentUrl,function(e,t){e?r._fireError(g.ErrorFactory.createHttpRequestError(e)):r._start_createElement(t)})},m.prototype._parseEngineConfig=function(e){var t;try{t=JSON.parse(e)}catch(e){return this._fireError(g.ErrorFactory.createInvalidGameError(e)),null}return null==t.engine_urls&&(t.engine_urls=[]),null==t.external&&(t.external=[]),t},m.prototype._start_createElement=function(e){var t,r,n=this;if(!this._destroyed){var i=this._gameContentShared,o=this._engineConfig=this._parseEngineConfig(e);if(o){var a=o.untrusted,s=!!this._givenRunInIframe||!!o.runInIframe,l=this._givenUntrusted;this._untrusted=!0===l||null==l&&!0===a,this._element=new u.GameContentElement({parent:i.gameViewElement,frameSrc:this._untrusted&&null!==(r=null!==(t=this._untrustedFrameUrl)&&void 0!==t?t:this._gameViewShared.untrustedFrameUrl)&&void 0!==r?r:null,onCreated:function(e,t){return n._start_startLoader(e,t)},runInIframe:s}),this._element.addDroppedDomEventListener(this._handleDroppedDomEvent_bound),null==this._contentArea&&this.setContentArea({x:0,y:0,width:i.viewWidth,height:i.viewHeight}),null==this._zIndex&&this.setZIndex(++i.largestZIndex),null==this._dataBus&&this._initDataBus()}}},m.prototype._start_startLoader=function(e,o){var a=this;if(!this._destroyed){var t=this._engineConfig;if(this._untrusted){var r=this._getUntrustedFrameHostname(),n=e.location.hostname;if(!r||""!==n&&0===r.indexOf(n))return void this._fireError(g.ErrorFactory.createInsecureFrameUrlError());var i=this._element.getContentWindow(),s=this._getUntrustedTargetOrigin();this._loader=new _.UntrustedGameLoader({engineConfig:t,shared:this._gameViewShared,customizer:this._customizer,audioPdiHandler:this._audioPdiHandlers,contentWindow:i,targetOrigin:s})}else this._loader=new p.TrustedGameLoader({engineConfig:t,shared:this._gameViewShared,customizer:this._customizer,audioPdiHandler:this._audioPdiHandlers,window:e});for(var l={},u=0;u<this._engineConfig.external.length;u++){var d=this._gameViewShared.pluginManager.find(this._engineConfig.external[u]);d&&d.untrustedSignature&&(l[d.name]=d.untrustedSignature)}var h={type:"object",content:l};this._loader.start({parentHtmlElement:o,contentUrl:this._contentUrl,initialEvents:this._initialEvents,argument:this._argument,pause:this._pauseOnStart,player:this._player,playConfig:this._playConfig,gameCreatedHandler:function(r){if(a._loader){a._workaroundEngine(o),a._handleGameArgument(a._argument),a._loader.setTabIndex(a._tabIndex),a._naturalWidth=r.width,a._naturalHeight=r.height,a._contentLayoutNeedsUpdate=!0,a._isReplay=a._playConfig.executionMode===c.ExecutionMode.Replay,a._isDropEventNeedsUpdate=!0,a._isRunning=!0,a._update();var n=[],i=function(e){if(!(0<=n.indexOf(e))){var t=a._gameViewShared.pluginManager.find(e);if(null!=t){n.push(e),t.requires&&t.requires.forEach(i);try{t.onload(r,a.getPluginDataBus(),a)}catch(e){console.error(e)}}}};a._engineConfig.external.forEach(i),a._gameViewShared.pluginManager.implicitPluginNames().forEach(i),r.skippingChangedTrigger&&r.skippingChangedTrigger.handle(function(t){a._skippingListeners.forEach(function(e){return e.onSkip(t)})});var t=((new Date).getTime()-a._loadStartTime)/1e3;a._contentLoadListeners.forEach(function(e){return e.onLoad(t)})}},errorHandler:function(t){return a._errorListeners.forEach(function(e){return e.onError(t)})},gameFinishedHandler:function(){a._isRunning=!1},replayData:this._replayData||this._playConfig.replayData,externalPluginSignature:h})}},m.prototype._update=function(){if(null!=this._element){if(this._contentAreaNeedsUpdate||this._contentLayoutNeedsUpdate){this._element.setContentArea(this._contentArea),this._element.setContentLayout(this._contentLayout);var e={outerWidth:this._contentArea.width,outerHeight:this._contentArea.height,naturalWidth:this._naturalWidth,naturalHeight:this._naturalHeight,horizontalAlignment:this._contentLayout.horizontalAlignment,verticalAlignment:this._contentLayout.verticalAlignment},t=void 0;switch(this._contentLayout.scaleMode){case c.ScaleMode.AspectFit:t=h.calcAspectFitLayout(e);break;case c.ScaleMode.Fill:t=h.calcFillLayout(e);break;default:t=h.calcNoneLayout(e)}this._element.setInnerSize(t),this._innerArea=t,this._isRunning&&this._loader&&(!this._loader.resizablePrimarySurface||t.width===this._naturalWidth&&t.height===this._naturalHeight||this._requestResizePrimarySurface(t.width,t.height),this._loader.setScale(t.width/this._naturalWidth,t.height/this._naturalHeight)),this._contentAreaNeedsUpdate=!1,this._contentLayoutNeedsUpdate=!1,this._notifyClickableAreas()}this._zIndexNeedsUpdate&&(this._element.setZIndex(this._zIndex),this._gameContentShared.largestZIndex=Math.max(this._gameContentShared.largestZIndex,this._zIndex),this._zIndexNeedsUpdate=!1),this._visibilityNeedsUpdate&&(this._element.setVisibility(this._visibility),this._visibilityNeedsUpdate=!1),this._isDropEventNeedsUpdate&&(this._updateDropEvent(),this._isDropEventNeedsUpdate=!1)}},m.prototype._initDataBus=function(){var e=new a.MemoryQueue,t=new a.MemoryQueue,r=new s.MemoryQueueDataBus(t,e),n=new s.MemoryQueueDataBus(e,t);this._dataBus=r,this._pluginDataBus=n},m.prototype.destroy=function(){this._destroyed||(this._loader&&(this._loader.stopGame(),this._loader=void 0),this._pluginDataBus&&(this._pluginDataBus.destroy(),this._pluginDataBus=void 0),this._dataBus&&(this._dataBus.destroy(),this._dataBus=void 0),this._element&&(this._element.destroy(),this._element=void 0),this._innerArea=void 0,this._destroyed=!0,this._cancelResizePrimarySurface(),o.prototype.destroy.call(this))},m.prototype.pause=function(){this._loader?this._loader.pauseGame():this._fireInvalidOperationError("pause")},m.prototype.resume=function(){this._loader?this._loader.resumeGame():this._fireInvalidOperationError("resume")},m.prototype.isPaused=function(){return this._loader?this._loader.isPaused():!!this._pauseOnStart},m.prototype.setEventDropPolicy=function(e){this._loader||this._fireInvalidOperationError("setEventDropPolicy"),this._eventDropPolicy!==e&&(this._eventDropPolicy=e,this._isDropEventNeedsUpdate=!0,this._update())},m.prototype.getEventDropPolicy=function(){var e;return null!==(e=this._eventDropPolicy)&&void 0!==e?e:c.EventDropPolicy.InReplay},m.prototype.setExecutionMode=function(e){this._loader&&this._loader.setExecutionMode(e)||this._fireInvalidOperationError("setExecutionMode");var t=e===c.ExecutionMode.Replay;this._isReplay!==t&&(this._isReplay=t,this._isDropEventNeedsUpdate=!0),this._update()},m.prototype.getExecutionMode=function(){return this._loader?this._loader.getExecutionMode():this._playConfig.executionMode},m.prototype.setReplayTargetTimeFunc=function(e){this._loader&&this._loader.setReplayTargetTimeFunc(e)||this._fireInvalidOperationError("setReplayTargetTimeFunc")},m.prototype.getReplayTargetTimeFunc=function(){return this._loader?this._loader.getReplayTargetTimeFunc():null},m.prototype.setReplayOriginDate=function(e){this._loader&&this._loader.setReplayOriginDate(e)||this._fireInvalidOperationError("setReplayOriginDate")},m.prototype.getReplayOriginDate=function(){return this._loader?this._loader.getReplayOriginDate():null},m.prototype.getAverageFramePerSecond=function(e){var t=this;this._loader?setTimeout(function(){return e(t._loader?t._loader.fps:0)},0):this._fireInvalidOperationError("getAverageFramePerSecond")},m.prototype.addSkippingListener=function(e){this._skippingListeners.addItem(e)},m.prototype.removeSkippingListener=function(e){this._skippingListeners.removeItem(e)},m.prototype.addDroppedEventListener=function(e){this._droppedListeners.addItem(e)},m.prototype.removeDroppedEventListener=function(e){this._droppedListeners.removeItem(e)},m.prototype.sendEvents=function(e){this._loader?this._loader.sendEvents(e):this._fireInvalidOperationError("sendEvents")},m.prototype.getPlayOriginDate=function(){return this._loader?this._loader.getPlayOriginDate():null},m.prototype.getGameVars=function(e,t){this._loader?this._loader.getGameVars(e,t):this._fireInvalidOperationError("getGameVars")},m.prototype.getGame=function(){if(this._loader)return this._loader.game;this._fireInvalidOperationError("getGame")},m.prototype.getGameDriver=function(){if(this._loader)return this._loader.driver;this._fireInvalidOperationError("getGameDriver")},m.prototype.getPluginDataBus=function(){return this._pluginDataBus},m.prototype.dumpPlaylog=function(){return this._loader?this._loader.dumpPlaylog():null},m.prototype.getGameContentSize=function(){var e=this.getGame();return{width:e.width,height:e.height}},m.prototype.setGameContentSize=function(e){if(this._loader)return this._loader.resetPrimarySurface(e.width,e.height),this._naturalWidth=e.width,void(this._naturalHeight=e.height);this._fireInvalidOperationError("setGameContentSize")},m.prototype.getMasterVolume=function(){return this._loader?this._loader.getMasterVolume():(this._fireInvalidOperationError("getMasterVolume"),null)},m.prototype.setMasterVolume=function(e){this._loader?this._loader.setMasterVolume(e):this._fireInvalidOperationError("setMasterVolume")},m.prototype.setTabIndex=function(e){this._loader?this._loader.setTabIndex(e):this._fireInvalidOperationError("setTabIndex")},m.prototype.getTabIndex=function(){return this._tabIndex},m.prototype.getClickableAreas=function(){var e,t,r=this;return null!==(t=null===(e=this._clickableRegions)||void 0===e?void 0:e.map(function(e){return r._areaOfGameScreenRegion(e)}))&&void 0!==t?t:null},m.prototype.addClickableAreasListener=function(e){this._clickableAreasListeners.addItem(e)},m.prototype.removeClickableAreasListener=function(e){this._clickableAreasListeners.removeItem(e)},m.prototype.handleSetClickableRegions=function(e){this._clickableRegions=e,this._notifyClickableAreas()},m.prototype._notifyClickableAreas=function(){var e,t,r=this,n=null!==(t=null===(e=this._clickableRegions)||void 0===e?void 0:e.map(function(e){return r._areaOfGameScreenRegion(e)}))&&void 0!==t?t:null;this._clickableAreasListeners.forEach(function(e){return e(n)})},m.prototype._areaOfGameScreenRegion=function(e){var t=e.x,r=e.y,n=e.width,i=e.height,o=this._contentArea,a=o.x,s=o.y,l=this._innerArea,u=l.x,d=l.y,h=l.width,c=l.height,p=h/this._naturalWidth,_=c/this._naturalHeight;return{x:a+u+t*p,y:s+d+r*_,width:n*p,height:i*_}},m.prototype._fireInvalidOperationError=function(e){this._fireError(g.ErrorFactory.createInvalidOperationError(e))},m.prototype._fireError=function(t){this._errorListeners.forEach(function(e){return e.onError(t)})},m.prototype._getUntrustedTargetOrigin=function(){if(null!=this._untrustedFrameTargetOrigin)return this._untrustedFrameTargetOrigin;if(!this._untrustedFrameUrl&&null!=this._gameViewShared.untrustedFrameTargetOrigin)return this._gameViewShared.untrustedFrameTargetOrigin;var e=this._untrustedFrameUrl||this._gameViewShared.untrustedFrameUrl;if(!e)return null;var t=e.match(/^(https?:\/\/[^\/]*)\//);return t&&t[1]?t[1]:null},m.prototype._getUntrustedFrameHostname=function(){var e=this._untrustedFrameUrl||this._gameViewShared.untrustedFrameUrl;if(!e)return null;var t=e.match(/^https?:\/\/([^\/:]*)(?::\d+)?\//);return t&&t[1]?t[1]:null},m.prototype._workaroundEngine=function(e){for(var t=e.getElementsByClassName("input-handler"),r=0;r<t.length;++r)t[r].setAttribute("tabindex","0")},m.prototype._handleGameArgument=function(e){if(e&&e.agv){var t=e.agv;(null==t?void 0:t.disableDropEventInReplay)&&void 0===this._eventDropPolicy&&(this._eventDropPolicy=c.EventDropPolicy.Never,this._isDropEventNeedsUpdate=!0)}},m.prototype._requestResizePrimarySurface=function(e,t){var n=this;if(this._bufferingNaturalWidth=Math.ceil(e),this._bufferingNaturalHeight=Math.ceil(t),this._lastUpdatePrimarySurfaceSizeTime=Date.now(),null==this._updatePrimarySurfaceSizeTimeoutId){var i=function(){var e=n._bufferingNaturalWidth,t=n._bufferingNaturalHeight,r=n._lastUpdatePrimarySurfaceSizeTime;Date.now()<r+n._updatePrimarySurfaceSizeDelay?n._updatePrimarySurfaceSizeTimeoutId=window.setTimeout(i,n._updatePrimarySurfaceSizeDelay):(n._naturalWidth=e,n._naturalHeight=t,n._bufferingNaturalWidth=null,n._bufferingNaturalHeight=null,n._loader.setScale(1,1),n._loader.resetPrimarySurface(n._naturalWidth,n._naturalHeight),n._updatePrimarySurfaceSizeTimeoutId=null)};this._updatePrimarySurfaceSizeTimeoutId=window.setTimeout(i,this._updatePrimarySurfaceSizeDelay)}},m.prototype._cancelResizePrimarySurface=function(){null!=this._updatePrimarySurfaceSizeTimeoutId&&(window.clearTimeout(this._updatePrimarySurfaceSizeTimeoutId),this._updatePrimarySurfaceSizeTimeoutId=null)},m.prototype._handleDroppedDomEvent=function(e,t){var r={type:e,reason:c.DroppedEventReason.Replay};this._droppedListeners.forEach(function(e){return e(r)})},m.prototype._updateDropEvent=function(){var e,t=null!==(e=this._eventDropPolicy)&&void 0!==e?e:c.EventDropPolicy.InReplay,r=t===c.EventDropPolicy.Always||t===c.EventDropPolicy.InReplay&&this._isReplay;this._element.setDropDomEvent(r)},m);function m(e){var t,r,n=o.call(this,e,"game")||this;return n._skippingListeners=new d.ObjectList,n._clickableAreasListeners=new d.ObjectList,n._droppedListeners=new d.ObjectList,n._loadStartTime=0,n._isRunning=!1,n._isReplay=!1,n._naturalWidth=0,n._naturalHeight=0,n._innerArea={x:0,y:0,width:0,height:0},n._bufferingNaturalWidth=null,n._bufferingNaturalHeight=null,n._updatePrimarySurfaceSizeTimeoutId=null,n._lastUpdatePrimarySurfaceSizeTime=null,n._updatePrimarySurfaceSizeDelay=1e3,n._untrusted=!1,n._replayData=null,n._engineConfig=null,n._destroyed=!1,n._clickableRegions=null,n._eventDropPolicy=void 0,n._isDropEventNeedsUpdate=!1,n._handleDroppedDomEvent_bound=n._handleDroppedDomEvent.bind(n),n._loader=null,n._element=null,n._pluginDataBus=null,n._contentUrl=e.contentUrl,n._player=e.player,n._playConfig=e.playConfig,n._untrustedFrameUrl=e.untrustedFrameUrl,n._untrustedFrameTargetOrigin=e.untrustedFrameTargetOrigin,n._argument=e.argument,n._pauseOnStart=!!e.pause,n._initialEvents=e.initialEvents,n._givenUntrusted=e.untrusted,n._givenRunInIframe=!!e.runInIframe,n._customizer=e.gameLoaderCustomizer,n._audioPdiHandlers=e.audioPdiHandlers,n._eventDropPolicy=null!==(t=e.eventDropPolicy)&&void 0!==t?t:void 0,n._tabIndex=null!==(r=e.tabIndex)&&void 0!==r?r:"0",n}r.GameContent=f},{"./CalcLayout":2,"./Content":3,"./DomElement":4,"./Error":6,"./TrustedGameLoader":13,"./UntrustedGameLoader":15,"./utils":27,"@akashic/akashic-gameview":28,"@cross-border-bridge/memory-queue":38,"@cross-border-bridge/memory-queue-data-bus":37}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ScriptManager=void 0;var n=(i._addScriptElement=function(e,t,r){var n=e.document.createElement("script");n.src=t,n.addEventListener("load",function(){r(null)}),n.addEventListener("error",function(){r(new Error("failed to load script: "+t))}),e.document.head.appendChild(n)},i.prototype.appendScripts=function(e,t,r){var n=this,i=[],o=t.length;o?t.forEach(function(t){n._appendScript(e,t,function(e){e&&i.push(t),0<--o||(0===i.length?r(null):r(new Error("failed to load scripts: "+i.join(", "))))})}):setTimeout(function(){return r(null)},0)},i.prototype._appendScript=function(e,r,t){this._loadedTableMap.has(e)||this._loadedTableMap.set(e,Object.create(null));var n=this._loadedTableMap.get(e);if(n[r])setTimeout(function(){return t(null)},0);else{this._loadingTableMap.has(e)||this._loadingTableMap.set(e,Object.create(null));var i=this._loadingTableMap.get(e);i[r]?i[r].push(t):(i[r]=[t],this._loadFunc(e,r,function(t){t||(n[r]=!0);var e=i[r];delete i[r],e.forEach(function(e){return e(t)})}))}},i);function i(e){this._loadedTableMap=new WeakMap,this._loadingTableMap=new WeakMap,this._loadFunc=e||i._addScriptElement}r.ScriptManager=n},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SessionManager=void 0;var n=(i.prototype.isInitialized=function(){return!!this._playlogClient},i.prototype.initialize=function(e){this._playlogClient=e},i.prototype.setSocketOptions=function(e){this._socketOpts=e},i.prototype.getSession=function(r,e,t,n){var i=this;if(this._playlogClient){var o=this._activeSessionTable[r];if(null!=o)return++o.refCount,void setTimeout(function(){n(null,o.session,!1)},0);var a=this._playlogClient.Socket.Type.WebSocket,s=new this._playlogClient.Session(r,{socketType:a,validationData:t,socketOpts:this._socketOpts});s.on("error",function(t){var e=i._activeSessionTable[r];null!=e&&e.errorHandlers.forEach(function(e){return e(t)})}),s.open(function(e){e?setTimeout(function(){n(e,null,!0)},0):(i._activeSessionTable[r]={session:s,refCount:1,errorHandlers:[]},setTimeout(function(){n(null,s,!0)},0))})}else setTimeout(function(){return n(new Error("playlog-client not initialized"),null,!0)})},i.prototype.addErrorHandler=function(e,t){var r=this._activeSessionTable[e];null!=r&&r.errorHandlers.push(t)},i.prototype.removeErrorHandler=function(e,t){var r=this._activeSessionTable[e];null!=r&&(r.errorHandlers=r.errorHandlers.filter(function(e){return e!==t}))},i.prototype.releaseSession=function(e){var t=this._activeSessionTable[e];null!=t&&--t.refCount<1&&(t.session.close(function(){}),this._activeSessionTable[e]=null)},i);function i(){this._activeSessionTable={},this._playlogClient=null,this._socketOpts=null}r.SessionManager=n},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GameContentSharedObject=r.GameViewSharedObject=void 0;var n=e("./ExternalPluginManager"),i=e("./SessionManager"),o=e("./Downloader"),a=e("./ScriptManager"),s=e("./bridge/PostMessageBridgeDemux"),l=(u.prototype.destroy=function(){this.pluginManager=null,this.sessionManager=null,this.scriptManager=null,(this.downloader=null)!=this.bridgeDemux&&this.bridgeDemux.destroy(),this.bridgeDemux=null},u.prototype.destroyed=function(){return null==this.bridgeDemux},u);function u(e){if((null==e?void 0:e.trustedChildOrigin)&&(null==e?void 0:e.untrustedFrameUrl)&&!e.trustedChildOrigin.test(e.untrustedFrameUrl))throw new Error("untrustedFrameUrl and trustedChildOrigin values do not match.");this.pluginManager=new n.ExternalPluginManager,this.sessionManager=new i.SessionManager,this.scriptManager=new a.ScriptManager,this.downloader=new o.RetryDownloader(e?e.baseDownloader:void 0),this.bridgeDemux=new s.PostMessageBridgeDemux((null==e?void 0:e.window)||window,null==e?void 0:e.trustedChildOrigin),this.untrustedFrameUrl=null==e?void 0:e.untrustedFrameUrl,this.untrustedFrameTargetOrigin=(null==e?void 0:e.untrustedFrameTargetOrigin)||null}r.GameViewSharedObject=l;function d(e){this.gameViewElement=e.gameViewElement,this.largestZIndex=0,this.viewWidth=e.gameViewWidth,this.viewHeight=e.gameViewHeight}r.GameContentSharedObject=d},{"./Downloader":5,"./ExternalPluginManager":7,"./ScriptManager":10,"./SessionManager":11,"./bridge/PostMessageBridgeDemux":21}],13:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.TrustedGameLoader=void 0;var o,a=e("./Error"),s=e("./TrustedGameLoaderBase"),l=(o=s.TrustedGameLoaderBase,i(u,o),u.prototype._getAdditionalScripts=function(e){var r=this,n=[];return 0===e.external.length||e.external.forEach(function(e){var t=r._shared.pluginManager.find(e);null!=t&&null!=t.scriptUrls&&t.scriptUrls.forEach(function(e){return n.push(e)})}),n},u.prototype._loadScripts=function(e,t,r){this._shared.scriptManager.appendScripts(e,t,r)},u.prototype._initializeSessionManagerIfNeeded=function(e){e&&!this._sessionManager.isInitialized()&&this._sessionManager.initialize(e)},u.prototype._acquirePlaylogClientAMFlow=function(n,i){var o=this;this._sessionManager.getSession(n.playlogServerUrl,n.protocol,{playId:n.playId,token:n.playToken},function(e,t,r){e?i(e,null):(o._sessionManager.addErrorHandler(n.playlogServerUrl,o._onSessionManagerError_bound),t.createClient({usePrimaryChannel:r},i))})},u.prototype._releasePlaylogClientAMFlow=function(e){this._sessionManager.removeErrorHandler(this._playlogServerUrl,this._onSessionManagerError_bound),this._sessionManager.releaseSession(this._playlogServerUrl),this._onSessionManagerError_bound=null},u.prototype._onSessionManagerError=function(e){this._param.errorHandler(a.ErrorFactory.createPlaylogError(e))},u);function u(e){var t=o.call(this,e)||this;return t._shared=e.shared,t._sessionManager=e.shared.sessionManager,t._onSessionManagerError_bound=t._onSessionManagerError.bind(t),t}r.TrustedGameLoader=l},{"./Error":6,"./TrustedGameLoaderBase":14}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TrustedGameLoaderBase=void 0;var a=e("@akashic/akashic-gameview"),s=e("./Error"),l=e("./detectEngineFileObject"),n=e("./createProxyAudioPluginClass"),i=(o.prototype.start=function(e){this._param=e,this._isPaused=!!e.pause,this._downloadScripts()},o.prototype._downloadScripts=function(){var i=this,e=this._getAdditionalScripts(this._engineConfig),o=this._engineConfig.engine_urls.concat(e),t=o.filter(function(e){return!((0,l.isEngineFilesUrl)(e)&&(0,l.detectEngineFilesObject)(i._globalObject,e)||(0,l.isPlaylogClientUrl)(e)&&(0,l.detectPlaylogClientObject)(i._globalObject,e))});this._loadScripts(this._globalObject,t,function(e){if(e)i._param.errorHandler(s.ErrorFactory.createHttpRequestError(e));else{var t=(0,l.detectRuntimes)(i._globalObject,o),r=t[0],n=t[1];r?i._param.errorHandler(r):(i._g=n.g,i._GameDriver=n.GameDriver,i._PdiBrowser=n.PdiBrowser,i._initializeSessionManagerIfNeeded(n.PlaylogClient),i._playId=i._param.playConfig.playId,i._agvExecutionMode=i._param.playConfig.executionMode,i.isTestbed="playlogServerUrl"in i._param.playConfig,i._param.replayData?setTimeout(function(){return i._startReplayGame()},0):i.isTestbed?setTimeout(function(){return i._startPlaylogGame()},0):setTimeout(function(){return i._startStandaloneGame()},0))}})},o.prototype._startReplayGame=function(){var e=this,t=this._param.replayData;if(this._amflowClient=new this._GameDriver.MemoryAmflowClient({playId:this._playId,tickList:t.tickList,startPoints:t.startPoints}),this._param.playConfig.replayTargetTimeFunc&&t.startPoints&&t.startPoints[0]){var r=t.startPoints[0].timestamp,n=this._param.playConfig.replayTargetTimeFunc();null!=this._param.playConfig.replayOriginDate&&(n+=this._param.playConfig.replayOriginDate),this._replayOriginDateOffset=r-n}setTimeout(function(){return e._startGame()},0)},o.prototype._startStandaloneGame=function(){var e=this;this._customizer&&this._customizer.createCustomAmflowClient?(this._amflowClient=this._customizer.createCustomAmflowClient(),this._usingCustomAmflow=!0):this._amflowClient=new this._GameDriver.MemoryAmflowClient({playId:this._playId}),setTimeout(function(){return e._startGame()},0)},o.prototype._startPlaylogGame=function(){var r=this,e=this._param.playConfig;this._playToken=e.playToken,this._playlogServerUrl=e.playlogServerUrl,this._protocol=e.protocol||a.ProtocolType.WebSocket,this._customizer&&this._customizer.createCustomAmflowClient?(this._amflowClient=this._customizer.createCustomAmflowClient(),this._usingCustomAmflow=!0,setTimeout(function(){return r._startGame()},0)):this._acquirePlaylogClientAMFlow({playlogServerUrl:this._playlogServerUrl,protocol:this._protocol,playId:this._playId,playToken:this._playToken},function(e,t){e?r._param.errorHandler(s.ErrorFactory.createPlaylogError(e)):(r._amflowClient=t,r._startGame())})},o.prototype._startGame=function(){var t=this,e=this._createPlatform(),r=this._createGameDriver(e);r.gameCreatedTrigger.handle(function(e){t.game=e,"abortTrigger"in t.game&&t.game.abortTrigger.handle(function(){t._param.errorHandler(s.ErrorFactory.createAbortGameError())}),t._param.gameCreatedHandler(e)}),this.driver=r,this.platform=e,setTimeout(function(){return t._startGameDriver(r)},0)},o.prototype._createPlatform=function(){var n=this,e=null;try{var t=this._PdiBrowser,r={amflow:this._amflowClient,containerView:this._param.parentHtmlElement,audioPlugins:this._createAudioPlugins()};this._overwritePlatformParameter(r),e=new t.Platform(r),this._customizer&&this._customizer.platformCustomizer&&this._customizer.platformCustomizer(e,{g:this._g}),e.usingPointerEvents,this._rawLoadGameConfiguration=e.loadGameConfiguration,e.loadGameConfiguration=function(e,r){n._customLoadGameConfiguration(e,function(e,t){t.environment&&t.environment.surface&&t.environment.surface.resizablePrimary&&(n.resizablePrimarySurface=!0),r(e,t)})}}catch(e){return void this._param.errorHandler(s.ErrorFactory.createLoadMuduleError(e))}return e},o.prototype._customLoadGameConfiguration=function(e,t){var r=this,n="<agvw-queryparam>",i="<agvw-configuration>";if(e!==n)e!==i?-1===this._param.contentUrl.indexOf("?")?this._rawLoadGameConfiguration(e,t):setTimeout(function(){return t(null,{definitions:[{url:i,basePath:r._getAssetBase()},n]})},0):this._rawLoadGameConfiguration(this._engineConfig.content_url,t);else{var o=this._param.contentUrl.slice(this._param.contentUrl.indexOf("?")+1).split("&").reduce(function(e,t){var r=t.split("=");try{e[r[0]]=JSON.parse(decodeURIComponent(r[1]))}catch(e){}return e},{});setTimeout(function(){return t(null,o)},0)}},o.prototype._createGameDriver=function(e){var t=this;return new this._GameDriver.GameDriver({platform:e,player:this._param.player,errorHandler:function(e){return t._param.errorHandler(s.ErrorFactory.createGameDriverError(e))}})},o.prototype._startGameDriver=function(e){var t=this;this.driver.initialize(this._createInitializeParameter(),function(e){e?t._param.errorHandler(s.ErrorFactory.createGameDriverError(e)):(t._param.replayData||t._sendinitialEvents(),t._isPaused||t.driver.startGame(),t._isLoadEnded=!0,t._destroyed&&t.stopGame())})},o.prototype._createInitializeParameter=function(){var e=this._agvExecutionMode===a.ExecutionMode.Active&&!this._param.replayData,t=!!this._param.replayData||this._agvExecutionMode===a.ExecutionMode.Replay,r=this._isPaused,n=e?this._GameDriver.ExecutionMode.Active:this._GameDriver.ExecutionMode.Passive,i=null!=this._param.playConfig.replayOriginDate?this._param.playConfig.replayOriginDate+this._replayOriginDateOffset:this._replayOriginDateOffset,o=t?this._createLoopConfigurationForReplay(this._param.playConfig.replayTargetTimeFunc,i):this._createLoopConfigurationForRealtime(this._param.playConfig.replayTargetTimeFunc,i);return{configurationUrl:this._engineConfig.content_url,assetBase:this._getAssetBase(),profiler:this._getProfiler(),gameArgs:this._param.argument,driverConfiguration:{playId:this._playId,playToken:this._playToken,executionMode:n,eventBufferMode:{isSender:!r&&!e&&!t,isReceiver:e,isDiscarder:r}},loopConfiguration:o}},o.prototype._getAssetBase=function(){var e=this._engineConfig.asset_base_url;if(null==e){var t=this._engineConfig.content_url;e=t.substr(0,t.lastIndexOf("/"))+"/"}return e},o.prototype._getProfiler=function(){var t=this,e=null;return this._GameDriver.SimpleProfiler&&(e=new this._GameDriver.SimpleProfiler({interval:200,getValueHandler:function(e){t.fps=e.framePerSecond.ave}})),e},o.prototype._sendinitialEvents=function(){var t=this;if(this._param.initialEvents)try{this._param.initialEvents.forEach(function(e){return t._amflowClient.sendEvent(e)})}catch(e){this._param.errorHandler(s.ErrorFactory.createPlaylogError(e))}},o.prototype.pauseGame=function(){this._isPaused||(this._isPaused=!0,this._isLoadEnded&&(this.driver._eventBuffer.setMode({isSender:!1,isDiscarder:!0}),this.driver.stopGame(),this.game._setMuted(!0)))},o.prototype.resumeGame=function(){if(this._isPaused&&(this._isPaused=!1,this._isLoadEnded)){this.driver.startGame();var e=this._agvExecutionMode===a.ExecutionMode.Active,t=this._agvExecutionMode===a.ExecutionMode.Replay;this.driver._eventBuffer.setMode({isSender:!e&&!t,isDiscarder:!1}),this.game._setMuted(!1)}},o.prototype.isPaused=function(){return this._isPaused},o.prototype.stopGame=function(){var e=this;this._destroyed=!0,this._isLoadEnded&&(this.game&&this.game.audio&&(this.game.audio.stopAll?this.game.audio.stopAll():(this.game.audio.music.stopAll(),this.game.audio.sound.stopAll()),this.game.audio.music.stopAll(),this.game.audio.sound.stopAll()),this.driver.stopGame(),this.driver.initialize({driverConfiguration:{playId:null},configurationUrl:null},function(){e.isTestbed&&!e._usingCustomAmflow&&e._releasePlaylogClientAMFlow(e._playlogServerUrl),e._amflowClient=null,e._g=null,e._GameDriver=null,e._PdiBrowser=null,e.game=null,e.platform=null,e.driver.destroy?e.driver.destroy().then(function(){return e._param.gameFinishedHandler()}):setTimeout(function(){return e._param.gameFinishedHandler()})}))},o.prototype.sendEvents=function(e){var t=this;try{this.driver._eventBuffer&&this.driver._eventBuffer.onEvent?e.forEach(function(e){return t.driver._eventBuffer.onEvent(e)}):e.forEach(function(e){return t._amflowClient.sendEvent(e)})}catch(e){this._param.errorHandler(s.ErrorFactory.createPlaylogError(e))}},o.prototype.dumpPlaylog=function(){return this.isTestbed||!this._amflowClient.dump?null:this._amflowClient.dump()},o.prototype.getGameVars=function(e,t){var r=this;setTimeout(function(){r.game&&t(r.game.vars&&r.game.vars[e])},0)},o.prototype.setExecutionMode=function(e){if(!this.driver)return!1;if(!this.driver._gameLoop||!this.driver._eventBuffer)return!1;if(this._agvExecutionMode===e)return!0;this._agvExecutionMode=e;var t=this._agvExecutionMode===a.ExecutionMode.Active,r=!!this._param.replayData||this._agvExecutionMode===a.ExecutionMode.Replay,n=t?this._GameDriver.ExecutionMode.Active:this._GameDriver.ExecutionMode.Passive,i=r?this._createLoopConfigurationForReplay():this._createLoopConfigurationForRealtime();return this.driver._gameLoop.setExecutionMode(n),this.driver._gameLoop.setLoopConfiguration(i),this.driver._eventBuffer.setMode({isSender:!t&&!r,isReceiver:t}),!0},o.prototype._createLoopConfigurationForRealtime=function(e,t){return{loopMode:this._GameDriver.LoopMode.Realtime,delayIgnoreThreshold:o.REALTIME_DELAY_IGNORE_THRESHOLD,jumpTryThreshold:o.REALTIME_JUMP_TRY_THRESHOLD,targetTimeFunc:e,originDate:t}},o.prototype._createLoopConfigurationForReplay=function(e,t){return{loopMode:this._GameDriver.LoopMode.Replay,delayIgnoreThreshold:Number.MAX_VALUE,jumpTryThreshold:o.REPLAY_JUMP_TRY_THRESHOLD,targetTimeFunc:e,originDate:t}},o.prototype.getExecutionMode=function(){var e;return null!==(e=this._agvExecutionMode)&&void 0!==e?e:this._param.playConfig.executionMode},o.prototype.setReplayTargetTimeFunc=function(e){return!(!this.driver||!this.driver._gameLoop||(this.driver._gameLoop.setLoopConfiguration({targetTimeFunc:e}),0))},o.prototype.getReplayTargetTimeFunc=function(){if(!this.driver)return null;var e=this.driver.getLoopConfiguration();return e?e.targetTimeFunc:null},o.prototype.setReplayOriginDate=function(e){return!(!this.driver||!this.driver._gameLoop||(this.driver._gameLoop.setLoopConfiguration({originDate:e+this._replayOriginDateOffset}),0))},o.prototype.getReplayOriginDate=function(){if(!this.driver)return null;var e=this.driver.getLoopConfiguration();return e?e.originDate:null},o.prototype.getPlayOriginDate=function(){if(!this.driver||!this.driver._gameLoop)return null;var e=this.driver._gameLoop._startedAt;return e||null},o.prototype.getReplayOriginDateOffset=function(){return this._replayOriginDateOffset},o.prototype.resetPrimarySurface=function(e,t){var r=this.driver;r&&r.resetPrimarySurface&&r.resetPrimarySurface(e,t)},o.prototype.setScale=function(e,t){this.platform.setScale(e,t)},o.prototype.setMasterVolume=function(e){this.platform.setMasterVolume(e)},o.prototype.getMasterVolume=function(){return this.platform.getMasterVolume()},o.prototype.setTabIndex=function(e){var t,r;null===(r=(t=this.platform).setTabIndex)||void 0===r||r.call(t,e)},o.prototype._overwritePlatformParameter=function(e){},o.prototype._createAudioPlugins=function(){var e=this._PdiBrowser;return this._customizer&&this._customizer.createCustomAudioPlugins?this._customizer.createCustomAudioPlugins():this._audioPdiHandler?[(0,n.createProxyAudioPluginClass)(this._g,this._audioPdiHandler)]:[e.WebAudioPlugin,e.HTMLAudioPlugin]},o.REALTIME_DELAY_IGNORE_THRESHOLD=6,o.REALTIME_JUMP_TRY_THRESHOLD=3e4,o.REPLAY_JUMP_TRY_THRESHOLD=18e3,o);function o(e){var t;this._playToken="",this._agvExecutionMode=null,this._playlogServerUrl="",this._protocol=a.ProtocolType.WebSocket,this._amflowClient=null,this._g=null,this._GameDriver=null,this._PdiBrowser=null,this._usingCustomAmflow=!1,this._isLoadEnded=!1,this._isPaused=!1,this._engineConfig=null,this._destroyed=!1,this.isTestbed=!1,this.game=null,this.driver=null,this.platform=null,this.fps=0,this.resizablePrimarySurface=!1,this._replayOriginDateOffset=0,this._customizer=e.customizer,this._engineConfig=e.engineConfig,this._audioPdiHandler=e.audioPdiHandler,this._globalObject=null!==(t=e.window)&&void 0!==t?t:window,this._param=null,this._rawLoadGameConfiguration=null}r.TrustedGameLoaderBase=i},{"./Error":6,"./createProxyAudioPluginClass":25,"./detectEngineFileObject":26,"@akashic/akashic-gameview":28}],15:[function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.UntrustedGameLoader=r.GameDriverProxy=r.GameProxy=void 0;var s=e("@akashic/akashic-gameview"),i=e("@akashic/trigger"),o=e("./Error"),a=e("./detectEngineFileObject"),l=e("./bridge/LoaderMessage"),u=e("./bridge/setupAMFlowProxy"),d=e("./bridge/setupAudioPdiProxy"),h=e("./ExternalPluginSignatureCaller"),c=function(e){this.playId=e.playId,this.width=e.width,this.height=e.height,this.fps=e.fps,this.external={},this.skippingChangedTrigger=new i.Trigger,this._started=new i.Trigger,this._loaded=new i.Trigger};r.GameProxy=c;var p=(_.prototype.changeState=function(e,t){this._bridge.request(l.LoaderMessage.ChangeDriverState,e,function(e){e&&"string"==typeof e?t&&t(o.ErrorFactory.createGameDriverError(e)):t&&t(null)})},_);function _(e){this._bridge=e}r.GameDriverProxy=p;var g=(f.prototype.start=function(e){var r=this;this._param=e,this._isPaused=!!e.pause,this._replayTargetTimeFunc=e.playConfig.replayTargetTimeFunc,this._shared.bridgeDemux.register(this._contentWindow,this._targetOrigin,function(e,t){e?r._param.errorHandler(o.ErrorFactory.createPostMessageError(e)):(r._bridge=t,r._bridge.on(l.LoaderMessage.Error,function(e){return r._fireErrorTriggerIfNeeded(e)}),r._bridge.on(l.LoaderMessage.GameCreated,r._handleGameCreated_bound),r._bridge.on(l.LoaderMessage.AcquireAMFlow,r._handleAcquireAMFlow_bound),r._bridge.on(l.LoaderMessage.PlayOriginDate,r._handlePlayOriginDate_bound),r._bridge.on(l.LoaderMessage.ExternalSend,r._handleExternalSend_bound),r._bridge.on(l.LoaderMessage.External,r._handleExternalPlugin_bound),r._bridge.on(l.LoaderMessage.SkippingChanged,r._handleSkippingChanged_bound),r._bridge.on(l.LoaderMessage.GameLoaded,r._handleGameLoaded_bound),r._bridge.on(l.LoaderMessage.GameStarted,r._handleGameStarted_bound),r._audioPdiHandler&&(r._teardownAudioPdiProxy=(0,d.setupAudioPdiProxy)(r._audioPdiHandler,r._bridge)),r._start_initializePlaylogClient())})},f.prototype._start_initializePlaylogClient=function(){var r=this;if(this._shared.sessionManager.isInitialized())this._start_request();else{var n=(0,a.findPlaylogClientUrl)(this._engineConfig.engine_urls);n?this._shared.scriptManager.appendScripts(window,[n],function(e){if(e)r._param.errorHandler(o.ErrorFactory.createHttpRequestError(e));else{var t=(0,a.detectPlaylogClientObject)(window,n);t&&r._shared.sessionManager.initialize(t),r._start_request()}}):this._start_request()}},f.prototype._start_request=function(){var t=this,e=this._param;this._bridge.request(l.LoaderMessage.Start,{engineConfig:this._engineConfig,replayData:e.replayData,contentUrl:e.contentUrl,initialEvents:e.initialEvents,argument:e.argument,pause:this._isPaused,player:e.player,playConfig:n(n({},e.playConfig),{replayTargetTimeFunc:void 0}),proxyAudio:!!this._audioPdiHandler,externalPluginSignature:e.externalPluginSignature},function(e){return t._fireErrorTriggerIfNeeded(e)})},f.prototype.pauseGame=function(){this._isPaused||(this._isPaused=!0,this._bridge.send(l.LoaderMessage.PauseGame),this._updateTargetTimeNotifier())},f.prototype.resumeGame=function(){this._isPaused&&(this._isPaused=!1,this._bridge.send(l.LoaderMessage.ResumeGame),this._updateTargetTimeNotifier())},f.prototype.isPaused=function(){return this._isPaused},f.prototype.stopGame=function(){this._bridge&&(this._bridge.send(l.LoaderMessage.StopGame,null),this._teardownAudioPdiProxy&&this._teardownAudioPdiProxy(),this._releaseAMFlow(),this._bridge.destroy(),this._bridge=null,this._externalPluginCaller=null,this._handleSessionManagerError_bound=null,this._handleGameCreated_bound=null,this._handleAcquireAMFlow_bound=null,this._handlePlayOriginDate_bound=null,this._handleExternalSend_bound=null,this._handleExternalPlugin_bound=null,this._handleSkippingChanged_bound=null,this._handleGameLoaded_bound=null,this._handleGameStarted_bound=null,this._notifyTargetTime_bound=null,this._updateTargetTimeNotifier(),this._param.gameFinishedHandler())},f.prototype.sendEvents=function(e){this._bridge.send(l.LoaderMessage.SendEvents,e)},f.prototype.dumpPlaylog=function(){return null},f.prototype.getGameVars=function(e,r){var n=this;this._bridge.request(l.LoaderMessage.GetGameVars,e,function(e,t){if(!n._fireErrorTriggerIfNeeded(e))try{r(t)}catch(e){n._param.errorHandler(e)}})},f.prototype.setExecutionMode=function(e){return this._agvExecutionMode===e||(this._agvExecutionMode=e,this._bridge.send(l.LoaderMessage.SetExecutionMode,e),this._updateTargetTimeNotifier()),!0},f.prototype.getExecutionMode=function(){var e;return null!==(e=this._agvExecutionMode)&&void 0!==e?e:this._param.playConfig.executionMode},f.prototype.setReplayTargetTimeFunc=function(e){return this._replayTargetTimeFunc=e,this._updateTargetTimeNotifier(),!0},f.prototype.getReplayTargetTimeFunc=function(){var e;return null!==(e=this._replayTargetTimeFunc)&&void 0!==e?e:null},f.prototype.setReplayOriginDate=function(e){return this._replayOriginDate=e,this._bridge.send(l.LoaderMessage.SetReplayOriginDate,e),!0},f.prototype.getReplayOriginDate=function(){return this._replayOriginDate},f.prototype.getPlayOriginDate=function(){return this._playOriginDate},f.prototype.resetPrimarySurface=function(e,t){this._bridge.send(l.LoaderMessage.ResetSurface,{width:e,height:t})},f.prototype.setScale=function(e,t){this._bridge.send(l.LoaderMessage.SetScale,{xScale:e,yScale:t})},f.prototype.setMasterVolume=function(e){this._masterVolume!==e&&(this._masterVolume=e,this._bridge.send(l.LoaderMessage.SetMasterVolume,e))},f.prototype.getMasterVolume=function(){return this._masterVolume},f.prototype.setTabIndex=function(e){this._bridge.send(l.LoaderMessage.SetTabIndex,e)},f.prototype._fireErrorTriggerIfNeeded=function(e){return!(!e||"string"!=typeof e||(this._param.errorHandler(o.ErrorFactory.createGameDriverError(e)),0))},f.prototype._handleSessionManagerError=function(e){this._param.errorHandler(o.ErrorFactory.createPlaylogError(e))},f.prototype._releaseAMFlow=function(){if(this._teardownAMFlowProxy&&(this._teardownAMFlowProxy(),!this._usingCustomAmflow)){var e=this._param.playConfig.playlogServerUrl;this._shared.sessionManager.removeErrorHandler(e,this._handleSessionManagerError_bound),this._shared.sessionManager.releaseSession(e)}},f.prototype._handleGameCreated=function(e){if(this.game=new c(n(n({},e),{playId:this._param.playConfig.playId})),this.driver=new p(this._bridge),this._param.gameCreatedHandler(this.game),this._param.externalPluginSignature){var t=this._param.externalPluginSignature;this._externalPluginCaller=new h.ExternalPluginSignatureCaller(t,this.game.external)}this._updateTargetTimeNotifier()},f.prototype._handleAcquireAMFlow=function(e,t){function n(e){o._param.errorHandler(e),null==t||t(e.message)}function i(e){o._amflowClient=e,o._teardownAMFlowProxy=(0,u.setupAMFlowProxy)(e,o._bridge),null==t||t(null)}var r,o=this;if(null===(r=this._customizer)||void 0===r?void 0:r.createCustomAmflowClient)return this._usingCustomAmflow=!0,void i(this._customizer.createCustomAmflowClient());var a=this._param.playConfig;this._shared.sessionManager.getSession(a.playlogServerUrl,a.protocol||s.ProtocolType.WebSocket,{playId:a.playId,token:a.playToken},function(e,t,r){e?n(e):(o._shared.sessionManager.addErrorHandler(a.playlogServerUrl,o._handleSessionManagerError_bound),t.createClient({usePrimaryChannel:r},function(e,t){e?n(e):i(t)}))})},f.prototype._handlePlayOriginDate=function(e){"number"==typeof e&&(this._playOriginDate=e)},f.prototype._handleExternalSend=function(e){var t,r;(null===(r=null===(t=this.game)||void 0===t?void 0:t.external)||void 0===r?void 0:r.send)&&this.game.external.send(e)},f.prototype._handleExternalPlugin=function(e,t){var r;this._externalPluginCaller&&(null===(r=this.game)||void 0===r?void 0:r.external)&&this._externalPluginCaller.call(e.identifier,e.args,t)},f.prototype._handleSkippingChanged=function(e){var t;null===(t=this.game)||void 0===t||t.skippingChangedTrigger.fire(e)},f.prototype._handleGameLoaded=function(){var e;null===(e=this.game)||void 0===e||e._loaded.fire()},f.prototype._handleGameStarted=function(){var e;null===(e=this.game)||void 0===e||e._started.fire()},f.prototype._updateTargetTimeNotifier=function(){var e=this._agvExecutionMode!==s.ExecutionMode.Active,t=this.game&&e&&!this._isPaused&&this._replayTargetTimeFunc&&!!this._bridge;t&&!this._targetTimeNotifierTimer?this._targetTimeNotifierTimer=setInterval(this._notifyTargetTime_bound,this.game.fps):!t&&this._targetTimeNotifierTimer&&(clearInterval(this._targetTimeNotifierTimer),this._targetTimeNotifierTimer=null)},f.prototype._notifyTargetTime=function(){if(this._replayTargetTimeFunc){var e=this._replayTargetTimeFunc();this._bridge.send(l.LoaderMessage.TargetTime,e)}},f);function f(e){this._agvExecutionMode=null,this._amflowClient=null,this._externalPluginCaller=void 0,this._isPaused=!1,this._engineConfig=null,this.game=null,this.driver=null,this.fps=-1,this.resizablePrimarySurface=!1,this._teardownAudioPdiProxy=null,this._teardownAMFlowProxy=null,this._usingCustomAmflow=!1,this._shared=e.shared,this._customizer=e.customizer,this._audioPdiHandler=e.audioPdiHandler,this._engineConfig=e.engineConfig,this._targetOrigin=e.targetOrigin,this._contentWindow=e.contentWindow,this._replayOriginDate=0,this._playOriginDate=null,this._masterVolume=1,this._handleSessionManagerError_bound=this._handleSessionManagerError.bind(this),this._handleGameCreated_bound=this._handleGameCreated.bind(this),this._handleAcquireAMFlow_bound=this._handleAcquireAMFlow.bind(this),this._handlePlayOriginDate_bound=this._handlePlayOriginDate.bind(this),this._handleExternalSend_bound=this._handleExternalSend.bind(this),this._handleExternalPlugin_bound=this._handleExternalPlugin.bind(this),this._handleSkippingChanged_bound=this._handleSkippingChanged.bind(this),this._handleGameLoaded_bound=this._handleGameLoaded.bind(this),this._handleGameStarted_bound=this._handleGameStarted.bind(this),this._notifyTargetTime_bound=this._notifyTargetTime.bind(this),this._param=null,this._bridge=null,this._replayTargetTimeFunc=null}r.UntrustedGameLoader=g},{"./Error":6,"./ExternalPluginSignatureCaller":8,"./bridge/LoaderMessage":19,"./bridge/setupAMFlowProxy":23,"./bridge/setupAudioPdiProxy":24,"./detectEngineFileObject":26,"@akashic/akashic-gameview":28,"@akashic/trigger":36}],16:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.WebContent=void 0;var o,a=e("@cross-border-bridge/post-message-data-bus"),s=e("./Content"),l=e("./DomElement"),u=(o=s.Content,i(d,o),d.prototype.start=function(e,t){var r=this,n=(new Date).getTime();this._gameViewShared=e,this._gameContentShared=t,this._element=new l.WebContentElement(t.gameViewElement,this._contentUrl,function(){var e,t=((new Date).getTime()-n)/1e3;r._dataBus=new a.PostMessageDataBus(null!==(e=r._element.getContentWindow())&&void 0!==e?e:null),r._contentLoadListeners.forEach(function(e){return e.onLoad(t)})}),null==this._contentArea&&this.setContentArea({x:0,y:0,width:t.viewWidth,height:t.viewHeight}),null==this._zIndex&&this.setZIndex(++t.largestZIndex)},d.prototype._update=function(){null!=this._element&&(this._contentAreaNeedsUpdate&&(this._element.setContentArea(this._contentArea),this._contentAreaNeedsUpdate=!1),this._zIndexNeedsUpdate&&(this._element.setZIndex(this._zIndex),this._gameContentShared.largestZIndex=Math.max(this._gameContentShared.largestZIndex,this._zIndex),this._zIndexNeedsUpdate=!1),this._contentLayoutNeedsUpdate&&(this._element.setContentLayout(this._contentLayout),this._contentLayoutNeedsUpdate=!1),this._visibilityNeedsUpdate&&(this._element.setVisibility(this._visibility),this._visibilityNeedsUpdate=!1))},d.prototype.destroy=function(){this._element.destroy(),o.prototype.destroy.call(this)},d);function d(e){var t=o.call(this,e,"web")||this;return t._element=null,t}r.WebContent=u},{"./Content":3,"./DomElement":4,"@cross-border-bridge/post-message-data-bus":39}],17:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.AudioMessage=void 0,(i=n||(r.AudioMessage=n={})).Load="audio:load",i.Unload="audio:unload",i.CreatePlayer="audio:createPlayer",i.DestroyPlayer="audio:destroyPlayer",i.Play="audio:play",i.Stop="audio:stop",i.ChangeVolume="audio:changeVolume",i.ChangeRate="audio:changeRate"},{}],18:[function(e,t,r){"use strict";var n,i,o;Object.defineProperty(r,"__esModule",{value:!0}),r.BridgeAMFlowMessage=r.BridgeMessage=void 0,(n||(r.BridgeMessage=n={})).Init="bridge:init",(o=i||(r.BridgeAMFlowMessage=i={})).Open="amf:open",o.Close="amf:close",o.Authenticate="amf:authenticate",o.SendTick="amf:sendTick",o.SubscribeTick="amf:subscribeTick",o.UnsubscribeTick="amf:unsubscribeTick",o.ReceiveTick="amf:[t]",o.SendEvent="amf:sendEvent",o.SubscribeEvent="amf:subscribeEvent",o.UnsubscribeEvent="amf:unsubscribeEvent",o.ReceiveEvent="amf:[e]",o.GetTickList="amf:getTickList",o.PutStartPoint="amf:putStartPoint",o.GetStartPoint="amf:getStartPoint"},{}],19:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.LoaderMessage=void 0,(i=n||(r.LoaderMessage=n={})).Start="loader:start",i.PauseGame="loader:pauseGame",i.ResumeGame="loader:resumeGame",i.StopGame="loader:stopGame",i.SendEvents="loader:sendEvents",i.SetExecutionMode="loader:setExecutionMode",i.TargetTime="loader:targetTime",i.SetReplayOriginDate="loader:setReplayOriginDate",i.SetScale="loader:setScale",i.SetMasterVolume="loader:setMasterVolume",i.GetGameVars="loader:getGameVars",i.ChangeDriverState="loader:changeDriverState",i.ResetSurface="loader:resetSurface",i.SetTabIndex="loader:setTabIndex",i.GameCreated="loader:gameCreated",i.Error="loader:error",i.PlayOriginDate="loader:playOriginDate",i.AcquireAMFlow="loader:acquireAMFlow",i.ReleaseAMFlow="loader:releaseAMFlow",i.ExternalSend="loader:externalSend",i.External="loader:external",i.SkippingChanged="loader:skippingChanged",i.GameLoaded="loader:gameLoaded",i.GameStarted="loader:gameStarted"},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PostMessageBridgeBase=void 0;var n=(i.prototype.destroy=function(){this._target=null,this._requestHandlersTable=null,this._handlersTable=null},i.prototype.getTarget=function(){return this._target},i.prototype.request=function(e,t,r){var n="req".concat(this._requestIndex++),i=this._createRawMessageBase();i.type=e,i.data=t,i.reqId=n,this._target.window.postMessage(i,this._target.targetOrigin),this._requestHandlersTable[n]=r},i.prototype.send=function(e,t){var r=this._createRawMessageBase();r.type=e,r.data=t,this._target.window.postMessage(r,this._target.targetOrigin)},i.prototype.on=function(e,t){var r=this._handlersTable;(r[e]||(r[e]=[])).push({handler:t,isOnce:!1})},i.prototype.once=function(e,t){var r=this._handlersTable;(r[e]||(r[e]=[])).push({handler:t,isOnce:!0})},i.prototype.off=function(e,t){var r=this._handlersTable;r[e]&&0!==r[e].length&&(r[e]=r[e].filter(function(e){return e.handler!==t}))},i.prototype._respond=function(e,t,r){var n=this._createRawMessageBase();n.resId=e,n.data=r,n.errorMessage=null!=t?t:void 0,this._target.window.postMessage(n,this._target.targetOrigin)},i.prototype._handleRawMessageEvent=function(e){var r=this,t=e.data;if(e.source===this._target.window){var n=t.resId;if(null!=n){var i=this._requestHandlersTable[n];return delete this._requestHandlersTable[n],void i(t.errorMessage?new Error(t.errorMessage):null,t.data)}var o=this._handlersTable,a=t.type;if(a&&o&&o.hasOwnProperty(a)&&0<o[a].length){for(var s=o[a].concat(),l=t.reqId,u=null==l?void 0:function(e,t){r._respond(l,e,t)},d=!1,h=0;h<s.length;++h){var c=s[h];c.handler&&(c.handler(t.data,u),c.isOnce&&(d=!(c.handler=null)))}d&&this.off(a,null)}else null==t.reqId?console.warn("PostMessageBridgeBase: ignored unknown message",t):this._respond(t.reqId,"No corresponding handler",null)}else console.warn("PostMessageBridgeBase: got ".concat(JSON.stringify(t)," from unknown source"))},i.prototype._createRawMessageBase=function(){return{}},i.prototype._setImmediate=function(e){setTimeout(e,0)},i);function i(e){this._requestIndex=0,this._requestHandlersTable={},this._handlersTable={},this._target=e}r.PostMessageBridgeBase=n},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PostMessageBridgeDemux=void 0;var o=e("./BridgeMessage"),l=e("./PostMessageDemuxedBridge");function u(e,t){for(var r=0;r<e.length;++r)if(t(e[r]))return r;return-1}var n=(i.prototype.register=function(t,e,r){if(e&&this._trustedOriginRegExp&&this._trustedOriginRegExp.test(e)){var n=this.findBridge(t);if(n)this._setImmediate(function(){n.getTarget().targetOrigin!==e?r(new Error("PostMessageBridgeDemux#register(): targetOrigin mismatch: "+e)):r(null,n)});else{var i="PDBT".concat(this._targetIndex++),o=new l.PostMessageDemuxedBridge(i,{targetOrigin:e,window:t},this._handleDestroyBridge_bound);this._bridgeTable[i]=o;var a=u(this._waitingEvents,function(e){return e.source===t});if(-1!==a){var s=this._waitingEvents.splice(a,1)[0];o.processRawMessageEvent(s)}o.initialize(function(e){return r(null!=e?e:null,e?void 0:o)})}}else this._setImmediate(function(){return r(new Error("PostMessageDemuxedBridge#register(): untrusted origin: "+e))})},i.prototype.destroy=function(){var t=this;Object.keys(this._bridgeTable).forEach(function(e){return t._bridgeTable[e].destroy()}),this._window.removeEventListener("message",this._handleMessage_bound),this._window=null,this._waitingEvents=null,this._bridgeTable=null,this._trustedOriginRegExp=null,this._handleMessage_bound=null,this._handleDestroyBridge_bound=null},i.prototype.findBridge=function(t){return function(t,r){var e=Object.keys(t),n=u(e,function(e){return r(t[e])});return-1!==n?t[e[n]]:null}(this._bridgeTable,function(e){return e.getTarget().window===t})},i.prototype._handleDestroyBridge=function(e){delete this._bridgeTable[e.selfKey]},i.prototype._handleMessage=function(e){if(this._trustedOriginRegExp&&this._trustedOriginRegExp.test(e.origin)){var t=e.data,r=t.key,n=!r&&t.type===o.BridgeMessage.Init,i=n?this.findBridge(e.source):this._bridgeTable[r];i?i.processRawMessageEvent(e):n&&this._waitingEvents.push(e)}},i.prototype._setImmediate=function(e){setTimeout(e,0)},i);function i(e,t){this._waitingEvents=[],this._targetIndex=0,this._bridgeTable=Object.create(null),this._window=e,this._trustedOriginRegExp=t,this._handleMessage_bound=this._handleMessage.bind(this),this._handleDestroyBridge_bound=this._handleDestroyBridge.bind(this),this._window.addEventListener("message",this._handleMessage_bound)}r.PostMessageBridgeDemux=n},{"./BridgeMessage":18,"./PostMessageDemuxedBridge":22}],22:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.PostMessageDemuxedBridge=void 0;var o,a=e("./BridgeMessage"),s=e("./PostMessageBridgeBase"),l=(o=s.PostMessageBridgeBase,i(u,o),u.prototype.destroy=function(){this._handleBeforeDestroyFunc(this),o.prototype.destroy.call(this),this._isConnected=!1,this._handleBeforeDestroyFunc=null},u.prototype.initialize=function(e){this._isConnected?this._setImmediate(e):this.once(a.BridgeMessage.Init,function(){return e()})},u.prototype.processRawMessageEvent=function(e){this._handleRawMessageEvent(e)},u);function u(e,t,r){var n=o.call(this,t)||this;return n.selfKey=e,n._isConnected=!1,n._handleBeforeDestroyFunc=r,n.once(a.BridgeMessage.Init,function(e,t){null==t||t(null,n.selfKey),n._isConnected=!0}),n}r.PostMessageDemuxedBridge=l},{"./BridgeMessage":18,"./PostMessageBridgeBase":20}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setupAMFlowProxy=function(n,t){function e(e,t){n.open(e,function(e){return null==t?void 0:t(e?e.message:null)})}function r(e,t){n.close(function(e){return null==t?void 0:t(e?e.message:null)})}function i(e,r){n.authenticate(e,function(e,t){return e?null==r?void 0:r(e.message):null==r?void 0:r(null,t)})}function o(e){return n.sendTick(e)}function a(e){return n.sendEvent(e)}function s(e){return t.send(f.BridgeAMFlowMessage.ReceiveTick,e)}function l(e){return t.send(f.BridgeAMFlowMessage.ReceiveEvent,e)}function u(){return n.onTick(s)}function d(){return n.offTick(s)}function h(){return n.onEvent(l)}function c(){return n.offEvent(l)}function p(e,r){n.getTickList(e.begin,e.end,function(e,t){return e?null==r?void 0:r(e.message):null==r?void 0:r(null,t)})}function _(e,t){n.putStartPoint(e,function(e){return null==t?void 0:t(e?e.message:null)})}function g(e,r){n.getStartPoint(e,function(e,t){return e?null==r?void 0:r(e.message):null==r?void 0:r(null,t)})}return t.on(f.BridgeAMFlowMessage.Open,e),t.on(f.BridgeAMFlowMessage.Close,r),t.on(f.BridgeAMFlowMessage.Authenticate,i),t.on(f.BridgeAMFlowMessage.SendTick,o),t.on(f.BridgeAMFlowMessage.SendEvent,a),t.on(f.BridgeAMFlowMessage.SubscribeTick,u),t.on(f.BridgeAMFlowMessage.UnsubscribeTick,d),t.on(f.BridgeAMFlowMessage.SubscribeEvent,h),t.on(f.BridgeAMFlowMessage.UnsubscribeEvent,c),t.on(f.BridgeAMFlowMessage.GetTickList,p),t.on(f.BridgeAMFlowMessage.PutStartPoint,_),t.on(f.BridgeAMFlowMessage.GetStartPoint,g),function(){d(),c(),t.off(f.BridgeAMFlowMessage.Open,e),t.off(f.BridgeAMFlowMessage.Close,r),t.off(f.BridgeAMFlowMessage.Authenticate,i),t.off(f.BridgeAMFlowMessage.SendTick,o),t.off(f.BridgeAMFlowMessage.SendEvent,a),t.off(f.BridgeAMFlowMessage.SubscribeTick,u),t.off(f.BridgeAMFlowMessage.UnsubscribeTick,d),t.off(f.BridgeAMFlowMessage.SubscribeEvent,h),t.off(f.BridgeAMFlowMessage.UnsubscribeEvent,c),t.off(f.BridgeAMFlowMessage.GetTickList,p),t.off(f.BridgeAMFlowMessage.PutStartPoint,_),t.off(f.BridgeAMFlowMessage.GetStartPoint,g)}};var f=e("./BridgeMessage")},{"./BridgeMessage":18}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setupAudioPdiProxy=function(r,e){function t(e,t){r.loadAudioAsset(e,function(e){return null==t?void 0:t(e?e.message:null)})}function n(e){return r.unloadAudioAsset(e)}function i(e){return r.createAudioPlayer(e)}function o(e){return r.destroyAudioPlayer(e)}function a(e){return r.playAudioPlayer(e)}function s(e){return r.stopAudioPlayer(e)}function l(e){r.changeAudioVolume(e.audioPlayerId,e.volume)}function u(e){r.changeAudioPlaybackRate(e.audioPlayerId,e.playbackRate)}return e.on(d.AudioMessage.Load,t),e.on(d.AudioMessage.Unload,n),e.on(d.AudioMessage.CreatePlayer,i),e.on(d.AudioMessage.DestroyPlayer,o),e.on(d.AudioMessage.Play,a),e.on(d.AudioMessage.Stop,s),e.on(d.AudioMessage.ChangeVolume,l),e.on(d.AudioMessage.ChangeRate,u),function(){e.off(d.AudioMessage.Load,t),e.off(d.AudioMessage.Unload,n),e.off(d.AudioMessage.CreatePlayer,i),e.off(d.AudioMessage.DestroyPlayer,o),e.off(d.AudioMessage.Play,a),e.off(d.AudioMessage.Stop,s),e.off(d.AudioMessage.ChangeVolume,l),e.off(d.AudioMessage.ChangeRate,u)}};var d=e("./AudioMessage")},{"./AudioMessage":17}],25:[function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,r,a):i(t,r))||a);return 3<o&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(r,"__esModule",{value:!0}),r.createProxyAudioPluginClass=function(e,s){var t,r,l=function(u){function e(e,t,r,n,i,o,a,s){var l=u.call(this,t,r,n,i,o,a,s)||this;return l._handlerSet=e,l}return o(e,u),e.prototype.destroy=function(){this._handlerSet.unloadAudioAsset(this.id),u.prototype.destroy.call(this)},e.prototype._load=function(t){var r=this;this._handlerSet.loadAudioAsset({id:this.id,assetPath:this.path,duration:this.duration,loop:this.loop,hint:this.hint,offset:this.offset},function(e){e?t._onAssetError(r,e):t._onAssetLoad(r)})},e.prototype._assetPathFilter=function(e){return e},e}(null!==(t=e.AudioAsset)&&void 0!==t?t:a.AudioAsset),n=function(i){function t(e,t,r){var n=i.call(this,t)||this;return n._audioPlayerId=null,n._handlerSet=e,n._manager=null!=r?r:null,n}return o(t,i),t.prototype.changeVolume=function(e){i.prototype.changeVolume.call(this,e),this._notifyVolumeToHandler()},t.prototype._changeMuted=function(e){i.prototype._changeMuted.call(this,e),this._notifyVolumeToHandler()},t.prototype.play=function(e){null!=this._audioPlayerId&&this.stop(),this._audioPlayerId="ap".concat(t._audioPlayerIdCounter++),this._handlerSet.createAudioPlayer({assetId:e.id,audioPlayerId:this._audioPlayerId,isPlaying:!0,volume:this._calculateVolume(),playbackRate:1}),i.prototype.play.call(this,e)},t.prototype.stop=function(){null!=this._audioPlayerId&&(this._handlerSet.stopAudioPlayer(this._audioPlayerId),this._handlerSet.destroyAudioPlayer(this._audioPlayerId),this._audioPlayerId=null),i.prototype.stop.call(this)},t.prototype.notifyMasterVolumeChanged=function(){this._notifyVolumeToHandler()},t.prototype._notifyVolumeToHandler=function(){null!=this._audioPlayerId&&this._handlerSet.changeAudioVolume(this._audioPlayerId,this._calculateVolume())},t.prototype._calculateVolume=function(){var e,t,r,n=null!==(r=null===(t=null===(e=this._manager)||void 0===e?void 0:e.getMasterVolume)||void 0===t?void 0:t.call(e))&&void 0!==r?r:1;return this._system._muted?0:this.volume*this._system.volume*n},t._audioPlayerIdCounter=0,t}(null!==(r=e.AudioPlayer)&&void 0!==r?r:u.AudioPlayer);return function(){function e(){this.supportedFormats=[]}return e.isSupported=function(){return!0},e.prototype.createAsset=function(e,t,r,n,i,o,a){return void 0===i&&(i="music"===(null==n?void 0:n.id)),void 0===o&&(o={}),void 0===a&&(a=0),new l(s,e,t,r,n,i,o,a)},e.prototype.createPlayer=function(e,t){return new n(s,e,"boolean"!=typeof t?t:void 0)},e=i([function(e){}],e)}()};var a=e("@akashic/pdi-common-impl/lib/AudioAsset"),u=e("@akashic/pdi-common-impl/lib/AudioPlayer")},{"@akashic/pdi-common-impl/lib/AudioAsset":30,"@akashic/pdi-common-impl/lib/AudioPlayer":31}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPlaylogClientUrl=n,r.findPlaylogClientUrl=p,r.detectPlaylogClientObject=_,r.isEngineFilesUrl=g,r.detectEngineFilesObject=f,r.detectRuntimes=function(e,t){for(var r=null,n=null,i=null,o=null,a=null,s=0;s<t.length;s++){var l=t[s];if(g(l)){a=l;break}}if(a){var u=f(e,a);u&&(r=u.g,n=u.GameDriver,i=u.PdiBrowser)}var d=p(t);d&&(o=_(e,d));if(r&&n&&i)return[null,{g:r,GameDriver:n,PdiBrowser:i,PlaylogClient:o}];var h=null;try{r=e.require("@akashic/akashic-engine"),n=e.require("@akashic/game-driver"),i=e.require("@akashic/pdi-browser");try{o=e.require("@akashic/playlog-client")}catch(e){}if(r&&n&&i)return[null,{g:r,GameDriver:n,PdiBrowser:i,PlaylogClient:o}]}catch(e){h=e}return[c.ErrorFactory.createLoadMuduleError(h||new Error("unknown failure for require()")),null]};var c=e("./Error");function n(e){return/.*\/playlogClientV.*\.js$/.test(e)}function p(e){for(var t=0;t<e.length;t++){var r=e[t];if(n(r))return r}return null}function _(e,t){var r=t.match(/.*\/(playlogClientV.*)\.js$/);return r?e[r[1]]:null}function g(e){return/.*\/engineFilesV.*\.js$/.test(e)}function f(e,t){var r=t.match(/.*\/(engineFilesV.*)\.js$/);if(r&&e[r[1]]){var n=e[r[1]];return{g:n.akashicEngine,GameDriver:n.gameDriver,PdiBrowser:n.pdiBrowser}}return null}},{"./Error":6}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectList=void 0,r.assignObject=function(t,r){null!=r&&Object.keys(r).forEach(function(e){t[e]=r[e]});return t};var n=(i.prototype.addItem=function(e){this._objectList.push(e)},i.prototype.removeItem=function(t){this._objectList=this._objectList.filter(function(e){return e!==t})},i.prototype.removeAllItems=function(){this._objectList=[]},i.prototype.forEach=function(e){this._objectList.forEach(e)},i);function i(){this._objectList=[]}r.ObjectList=n},{}],28:[function(e,t,r){"use strict";var n,i,o,a,s,l,u,d;Object.defineProperty(r,"__esModule",{value:!0}),r.ProtocolType=r.ExecutionMode=r.HorizontalAlignment=r.VerticalAlignment=r.ScaleMode=r.DroppedEventType=r.DroppedEventReason=r.EventDropPolicy=void 0,(n=r.EventDropPolicy||(r.EventDropPolicy={}))[n.InReplay=0]="InReplay",n[n.Always=1]="Always",n[n.Never=2]="Never",(i=r.DroppedEventReason||(r.DroppedEventReason={}))[i.Unknown=0]="Unknown",i[i.Replay=1]="Replay",(o=r.DroppedEventType||(r.DroppedEventType={}))[o.Click=0]="Click",o[o.Down=1]="Down",o[o.Move=2]="Move",o[o.Up=3]="Up",(a=r.ScaleMode||(r.ScaleMode={}))[a.None=0]="None",a[a.Fill=1]="Fill",a[a.AspectFit=2]="AspectFit",(s=r.VerticalAlignment||(r.VerticalAlignment={}))[s.Top=0]="Top",s[s.Center=1]="Center",s[s.Bottom=2]="Bottom",(l=r.HorizontalAlignment||(r.HorizontalAlignment={}))[l.Left=0]="Left",l[l.Center=1]="Center",l[l.Right=2]="Right",(u=r.ExecutionMode||(r.ExecutionMode={}))[u.Active=0]="Active",u[u.Passive=1]="Passive",u[u.Replay=2]="Replay",(d=r.ProtocolType||(r.ProtocolType={}))[d.WebSocket=0]="WebSocket"},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Asset=void 0;var n=e("@akashic/trigger"),i=(o.prototype.destroy=function(){this.onDestroyed.fire(this),this.id=void 0,this.originalPath=void 0,this.path=void 0,this.onDestroyed.destroy(),this.onDestroyed=void 0},o.prototype.destroyed=function(){return void 0===this.id},o.prototype.inUse=function(){return!1},o.prototype._assetPathFilter=function(e){return e},o);function o(e,t){this.id=e,this.originalPath=t,this.path=this._assetPathFilter(t),this.onDestroyed=new n.Trigger}r.Asset=i},{"@akashic/trigger":36}],30:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.AudioAsset=void 0;var l,o=e("./Asset"),a=(l=o.Asset,i(s,l),s.prototype.play=function(){var e=this._system.createPlayer();return e.play(this),this._lastPlayedPlayer=e},s.prototype.stop=function(){for(var e=this._system.findPlayers(this),t=0;t<e.length;++t)e[t].stop()},s.prototype.inUse=function(){return 0<this._system.findPlayers(this).length},s.prototype.destroy=function(){this._system&&this.stop(),this.data=void 0,this._system=void 0,this._lastPlayedPlayer=void 0,l.prototype.destroy.call(this)},s);function s(e,t,r,n,i,o,a){var s=l.call(this,e,t)||this;return s.type="audio",s.duration=r,s.loop=i,s.hint=o,s._system=n,s.data=void 0,s.offset=a,s}r.AudioAsset=a},{"./Asset":29}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AudioPlayer=void 0;var n=e("@akashic/trigger"),i=(o.prototype.play=function(e){this.currentAudio=e,this.onPlay.fire({player:this,audio:e})},o.prototype.stop=function(){var e=this.currentAudio;e&&(this.currentAudio=void 0,this.onStop.fire({player:this,audio:e}))},o.prototype.canHandleStopped=function(){return!0},o.prototype.changeVolume=function(e){this.volume=e},o.prototype._changeMuted=function(e){this._muted=e},o.prototype._notifyVolumeChanged=function(){this.changeVolume(this.volume)},o);function o(e){this.onPlay=new n.Trigger,this.onStop=new n.Trigger,this.played=this.onPlay,this.stopped=this.onStop,this.currentAudio=void 0,this.volume=e.volume,this._muted=e._muted,this._system=e}r.AudioPlayer=i},{"@akashic/trigger":36}],32:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.ChainTrigger=void 0;var o,a=e("./Trigger"),s=(o=a.Trigger,i(l,o),l.prototype.add=function(e,t){o.prototype.add.call(this,e,t),this._isActivated||(this.chain.add(this._onChainTriggerFired,this),this._isActivated=!0)},l.prototype.addOnce=function(e,t){o.prototype.addOnce.call(this,e,t),this._isActivated||(this.chain.add(this._onChainTriggerFired,this),this._isActivated=!0)},l.prototype.remove=function(e,t){o.prototype.remove.call(this,e,t),0===this.length&&this._isActivated&&(this.chain.remove(this._onChainTriggerFired,this),this._isActivated=!1)},l.prototype.removeAll=function(e){o.prototype.removeAll.call(this,e),0===this.length&&this._isActivated&&(this.chain.remove(this._onChainTriggerFired,this),this._isActivated=!1)},l.prototype.destroy=function(){o.prototype.destroy.call(this),this.chain.remove(this._onChainTriggerFired,this),this.filter=null,this.filterOwner=null,this._isActivated=!1},l.prototype._onChainTriggerFired=function(e){this.filter&&!this.filter.call(this.filterOwner,e)||this.fire(e)},l);function l(e,t,r){var n=o.call(this)||this;return n.chain=e,n.filter=null!=t?t:null,n.filterOwner=r,n._isActivated=!1,n}r.ChainTrigger=s},{"./Trigger":34}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Trigger=void 0;var n=(i.prototype.add=function(e,t){if("function"==typeof e)this._handlers.push({func:e,owner:t,once:!1,name:void 0});else{var r=e;"number"==typeof r.index?this._handlers.splice(r.index,0,{func:r.func,owner:r.owner,once:!1,name:r.name}):this._handlers.push({func:r.func,owner:r.owner,once:!1,name:r.name})}this.length=this._handlers.length},i.prototype.addOnce=function(e,t){if("function"==typeof e)this._handlers.push({func:e,owner:t,once:!0,name:void 0});else{var r=e;"number"==typeof r.index?this._handlers.splice(r.index,0,{func:r.func,owner:r.owner,once:!0,name:r.name}):this._handlers.push({func:r.func,owner:r.owner,once:!0,name:r.name})}this.length=this._handlers.length},i.prototype.handle=function(e,t,r){this.add(t?{owner:e,func:t,name:r}:{func:e})},i.prototype.fire=function(e){if(this._handlers&&this._handlers.length){for(var t=this._handlers.concat(),r=0;r<t.length;r++){var n=t[r];if(n.func.call(n.owner,e)||n.once){if(!this._handlers)continue;var i=this._handlers.indexOf(n);-1!==i&&this._handlers.splice(i,1)}}null!=this._handlers&&(this.length=this._handlers.length)}},i.prototype.contains=function(e,t){for(var r="function"==typeof e?{func:e,owner:t}:e,n=0;n<this._handlers.length;n++)if(this._comparePartial(r,this._handlers[n]))return!0;return!1},i.prototype.remove=function(e,t){for(var r="function"==typeof e?{func:e,owner:t}:e,n=0;n<this._handlers.length;n++){var i=this._handlers[n];if(r.func===i.func&&r.owner===i.owner&&r.name===i.name)return this._handlers.splice(n,1),void--this.length}},i.prototype.removeAll=function(e){var t=[];if(e)for(var r=0;r<this._handlers.length;r++){var n=this._handlers[r];this._comparePartial(e,n)||t.push(n)}this._handlers=t,this.length=this._handlers.length},i.prototype.destroy=function(){this._handlers=null,this.length=null},i.prototype.destroyed=function(){return null===this._handlers},i.prototype._comparePartial=function(e,t){return!(void 0!==e.func&&e.func!==t.func||void 0!==e.owner&&e.owner!==t.owner||void 0!==e.name&&e.name!==t.name)},i);function i(){this._handlers=[],this.length=0}r.Trigger=n},{}],35:[function(e,t,r){arguments[4][33][0].apply(r,arguments)},{dup:33}],36:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./TriggerLike"),r),i(e("./ChainTriggerLike"),r),i(e("./Trigger"),r),i(e("./ChainTrigger"),r)},{"./ChainTrigger":32,"./ChainTriggerLike":33,"./Trigger":34,"./TriggerLike":35}],37:[function(e,t,r){var n=(i.prototype.send=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this._sender.send.apply(this._sender,e)},i.prototype.addHandler=function(e){this._handlers.push(e)},i.prototype.removeHandler=function(e){var t=this._handlers.indexOf(e);t<0||this._handlers.splice(t,1)},i.prototype.removeAllHandlers=function(){this._handlers=[]},i.prototype.destroy=function(){this.removeAllHandlers(),this._receiver.setHandler(void 0)},i);function i(e,t){this._sender=e,this._receiver=t,this._handlers=[];var r=this;this._receiver.setHandler(function(){for(var e=0,t=r._handlers;e<t.length;e++){t[e].apply(r,arguments)}})}r.MemoryQueueDataBus=n},{}],38:[function(e,t,r){var n=(i.prototype.setHandler=function(e){this._handler=e},i.prototype.send=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this._handler&&this._handler.apply(null,e)},i);function i(e){this._handler=e}r.MemoryQueue=n},{}],39:[function(e,t,r){var n=(i.prototype.send=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];this._target&&this._target.postMessage(JSON.stringify(e),"*")},i.prototype.addHandler=function(e){this._target&&(0===this._handlers.length&&function(e){Object.keys(a).length||window.addEventListener("message",l);var t=o.indexOf(e._target);-1===t&&(t=o.push(e._target)-1),a[t]||(a[t]=[]),a[t].push(e)}(this),this._handlers.push(e))},i.prototype.removeHandler=function(e){if(this._target){var t=this._handlers.indexOf(e);t<0||(this._handlers.splice(t,1),0===this._handlers.length&&s(this))}},i.prototype.removeAllHandlers=function(){this._target&&0!==this._handlers.length&&(this._handlers=[],s(this))},i.prototype._onMessage=function(e){if(this._target&&0!==this._handlers.length){for(var t=[],r=0,n=this._handlers;r<n.length;r++)(o=n[r]).apply(null,e)&&t.push(o);for(var i=0;i<t.length;i++){var o=t[i];this.removeHandler(o)}}},i.prototype.destroy=function(){this._target&&(this.removeAllHandlers(),this._target=void 0)},i);function i(e){this._target=e,this._handlers=[]}r.PostMessageDataBus=n;var o=[],a={};function s(t){var e=o.indexOf(t._target);-1!==e&&(a[e]=a[e].filter(function(e){return e!==t}),a[e].length||(delete a[e],o[e]=null),Object.keys(a).length||window.removeEventListener("message",l))}function l(e){var t=o.indexOf(e.source);if(-1!==t){var r=null;try{r=JSON.parse(e.data)}catch(e){return}a[t].forEach(function(e){e._onMessage(r)})}}},{}],"@akashic/akashic-gameview-web":[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalPluginSignatureCaller=r.ObjectList=r.GameContent=r.WebContent=r.RetryDownloader=r.XhrDownloader=r.Content=r.GameContentSharedObject=r.GameViewSharedObject=r.AkashicGameView=r.DroppedEventType=r.DroppedEventReason=r.EventDropPolicy=r.ProtocolType=r.ExecutionMode=r.HorizontalAlignment=r.VerticalAlignment=r.ScaleMode=void 0;var n=e("@akashic/akashic-gameview");Object.defineProperty(r,"ScaleMode",{enumerable:!0,get:function(){return n.ScaleMode}}),Object.defineProperty(r,"VerticalAlignment",{enumerable:!0,get:function(){return n.VerticalAlignment}}),Object.defineProperty(r,"HorizontalAlignment",{enumerable:!0,get:function(){return n.HorizontalAlignment}}),Object.defineProperty(r,"ExecutionMode",{enumerable:!0,get:function(){return n.ExecutionMode}}),Object.defineProperty(r,"ProtocolType",{enumerable:!0,get:function(){return n.ProtocolType}}),Object.defineProperty(r,"EventDropPolicy",{enumerable:!0,get:function(){return n.EventDropPolicy}}),Object.defineProperty(r,"DroppedEventReason",{enumerable:!0,get:function(){return n.DroppedEventReason}}),Object.defineProperty(r,"DroppedEventType",{enumerable:!0,get:function(){return n.DroppedEventType}});var i=e("./AkashicGameViewWeb");Object.defineProperty(r,"AkashicGameView",{enumerable:!0,get:function(){return i.AkashicGameView}});var o=e("./SharedObject");Object.defineProperty(r,"GameViewSharedObject",{enumerable:!0,get:function(){return o.GameViewSharedObject}}),Object.defineProperty(r,"GameContentSharedObject",{enumerable:!0,get:function(){return o.GameContentSharedObject}});var a=e("./Content");Object.defineProperty(r,"Content",{enumerable:!0,get:function(){return a.Content}});var s=e("./Downloader");Object.defineProperty(r,"XhrDownloader",{enumerable:!0,get:function(){return s.XhrDownloader}}),Object.defineProperty(r,"RetryDownloader",{enumerable:!0,get:function(){return s.RetryDownloader}});var l=e("./WebContent");Object.defineProperty(r,"WebContent",{enumerable:!0,get:function(){return l.WebContent}});var u=e("./GameContent");Object.defineProperty(r,"GameContent",{enumerable:!0,get:function(){return u.GameContent}});var d=e("./utils");Object.defineProperty(r,"ObjectList",{enumerable:!0,get:function(){return d.ObjectList}});var h=e("./ExternalPluginSignatureCaller");Object.defineProperty(r,"ExternalPluginSignatureCaller",{enumerable:!0,get:function(){return h.ExternalPluginSignatureCaller}})},{"./AkashicGameViewWeb":1,"./Content":3,"./Downloader":5,"./ExternalPluginSignatureCaller":8,"./GameContent":9,"./SharedObject":12,"./WebContent":16,"./utils":27,"@akashic/akashic-gameview":28}]},{},[]);